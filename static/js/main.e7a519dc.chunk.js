(this.webpackJsonppicsy=this.webpackJsonppicsy||[]).push([[0],{28:function(e,t,a){e.exports=a.p+"static/media/loader-timer.8835a88b.svg"},29:function(e,t,a){e.exports=a.p+"static/media/loader-button.3de4de61.svg"},30:function(e,t,a){e.exports=a.p+"static/media/loader-azure.df696f68.svg"},36:function(e,t,a){},39:function(e,t,a){e.exports=a.p+"static/media/loader-earth.5f4bc2b1.svg"},42:function(e,t,a){e.exports=a(96)},47:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){},67:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){},88:function(e,t,a){},89:function(e,t,a){},90:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(37),u=a.n(c),l=(a(47),a(4)),i=a(23);i.initializeApp({apiKey:"AIzaSyBTZQaxY4tK4wD1CFIAdZYoBNIFNXjpHZI",authDomain:"picsy-827e5.firebaseapp.com",databaseURL:"https://picsy-827e5.firebaseio.com",projectId:"picsy-827e5",storageBucket:"picsy-827e5.appspot.com",messagingSenderId:"228973782937",appId:"1:228973782937:web:8c6a64e32d37e3c8c7d508"});var o={users:i.firestore().collection("users"),albums:i.firestore().collection("albums"),pictures:i.firestore().collection("pictures"),getUser:function(e){var t=this;return new Promise((function(a,n){return t.users.doc(e).get().then((function(e){return a(e.get("pseudo")?e:null)})).catch((function(e){return n(e)}))}))},pictureSetFilters:function(e,t){var a=this;return new Promise((function(n,r){a.pictures.doc(e).get().then((function(c){var u=a.pictures.doc(e),i=c.get("filters").filter((function(e){return!t.find((function(t){return t.key===e.key}))}));u.get().then((function(){return u.set({name:c.get("name"),createAt:c.get("createAt"),album_id:c.get("album_id"),filters:[].concat(Object(l.a)(i),Object(l.a)(t)),blob:c.get("blob")}).then((function(){return n({success:!0})})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))}))},pictureSetFilter:function(e,t){var a=this;return new Promise((function(n,r){a.pictures.doc(e).get().then((function(c){var u=c.get("filters"),l=!1,i=u.map((function(e){try{"string"===typeof e&&(e=JSON.parse(e))}catch(a){e={}}return e.key===t.key&&(e.val=t.val,l=!0),e}));l||i.push(JSON.stringify({key:t.key,val:t.val}));var o=a.pictures.doc(e);o.get().then((function(){return o.set({name:c.get("name"),createAt:c.get("createAt"),album_id:c.get("album_id"),filters:i.filter((function(e){try{"string"===typeof e&&(e=JSON.parse(e))}catch(t){return!1}return e.key&&e.val})),blob:c.get("blob")}).then((function(){return n({success:!0})})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))}))},getImgsOf:function(e){var t=this;return new Promise((function(a,n){return t.albums.doc(e).get().then((function(){return t.pictures.get().then((function(t){return a(t.docs.filter((function(t){return t.get("album_id")===e})))})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))},addAlbum:function(e,t){var a=this;return new Promise((function(n,r){e||t||r({status:401}),a.getAlbumsOf(t).then((function(c){if(c.find((function(t){return t.get("name")===e})))return n({success:!1,status:401,details:"already exists"});a.albums.add({user_id:t,name:e,createAt:Date.now(),size:0}).then((function(){return n({success:!0})})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))}))},albumUp:function(e){var t=this;return new Promise((function(a,n){var r=t.albums.doc(e);r.get().then((function(e){r.set({createAt:e.get("createAt"),name:e.get("name"),size:parseInt(e.get("size"))+1,user_id:e.get("user_id")}).then((function(){return a({success:!0})})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))},albumDown:function(e){var t=this;return new Promise((function(a,n){var r=t.albums.doc(e);r.get().then((function(e){r.set({createAt:e.get("createAt"),name:e.get("name"),size:parseInt(e.get("size"))-1,user_id:e.get("user_id")}).then((function(){return a({success:!0})})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))},getPictureOf:function(e){var t=this;return new Promise((function(a,n){if(!e)return n();t.pictures.get().then((function(t){return a(t.docs.filter((function(t){return t.get("album_id")===e})))}))}))},addPicture:function(e,t,a){var n=this;return new Promise((function(r,c){if(!(e||t||a))return c();n.albums.doc(e).get().then((function(){n.getPictureOf(e).then((function(u){u.find((function(e){return e.get("name")===t}))?r({success:!1,status:401}):n.pictures.add({album_id:e,blob:a,createAt:Date.now(),name:t,filters:[]}).then((function(){n.albumUp(e).then((function(){r({success:!0})})).catch((function(e){return c(e)}))})).catch((function(e){return c(e)}))}))})).catch((function(e){return c({status:404})}))}))},rnameImg:function(e,t,a){var n=this;return new Promise((function(r,c){e||t||c();var u=n.pictures.doc(e);n.pictures.get().then((function(e){e.docs.find((function(e){return e.get("name")===t&&e.get("album_id")===a}))?r({success:!1,status:401,details:"name already exists"}):u.get().then((function(e){u.set({blob:e.get("blob"),album_id:e.get("album_id"),filters:e.get("filters")||[],name:t,createAt:e.get("createAt")||Date.now()}).then((function(){return r({success:!0})})).catch((function(e){return c(e)}))})).catch((function(e){return r({success:!1,status:404,err:e})}))})).catch((function(){return c()}))}))},rnameAlbum:function(e,t){var a=this;return new Promise((function(n,r){e||t||r();var c=a.albums.doc(e);c.get().then((function(e){e.get("name")===t&&n({success:!0}),c.set({name:t,createAt:e.get("createAt"),size:e.get("size"),user_id:e.get("user_id")}).then((function(){return n({success:!0})}))})).catch((function(e){return r(e)}))}))},getAlbumsOf:function(e){var t=this;return new Promise((function(a,n){return t.albums.get().then((function(t){return a(t.docs.filter((function(t){return t.get("user_id").trim()===e.trim()})))})).catch((function(e){return n(e)}))}))},removePicture:function(e){var t=this;return new Promise((function(a,n){if(!e)return n();var r=t.pictures.doc(e);if(!r||!(r.get instanceof Function))return a({status:404,success:!1});r.get().then((function(e){r.delete().then((function(){t.albumDown(e.get("album_id")).then((function(){a({success:!0})})).catch((function(e){return n(e)}))})).catch((function(){return n()}))}))}))},removeAlbum:function(e){var t=this;return new Promise((function(a,n){e||n({status:401,id:e});var r=t.albums.doc(e);r&&r.get instanceof Function||n({refAlbum:r,id:e,status:404}),r.get().then((function(){r.delete().then((function(){t.getPictureOf(e).then((function(e){e.map((function(e){return t.removePicture(e.id)})),a({success:!0})})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))}},s=a(10),m=a(7),f=a(13),d=a(11),p=a(17),b=a(12),h=(a(59),a(28)),g=a.n(h),v=a(39),E=a.n(v),y=a(29),O=a.n(y),j=a(30),S=a.n(j);function k(e){return{timer:g.a,btn:O.a,button:O.a,earth:E.a,azure:S.a,az:S.a}[e]||g.a}var I=function(e){var t=e.className,a=e.width,n=e.full,c=e.type,u=e.bg;return r.a.createElement("figure",{className:"Loader ".concat(t," ").concat(n?"full":""),style:{backgroundColor:u||"transparent"}},r.a.createElement("img",{alt:"loader ".concat(c),src:k(c),width:a}))},N=a(18),w=a(19),C=a.n(w);var D=function(e){var t=e.className,a=e.label,n=e.name,c=e.id,u=e.onChange,l=e.autoRead,i=e.notif;return r.a.createElement(r.a.Fragment,null,a&&r.a.createElement("label",{htmlFor:c||n},a),r.a.createElement("input",{className:t,type:"file",name:n,id:c||n,onChange:function(e){if(u instanceof Function){var t=e.target.files[0];if(l){var a=null,n=new FileReader,r=e;n.addEventListener("load",(function(e){a=e.target.result,u(t,a,r)})),n.readAsDataURL(t)}else u(t,e)}}}),i)},x=a(3);a(60);function F(e){var t={warn:"fas fa-exclamation-triangle",warning:"fas fa-exclamation-triangle",error:"fas fa-bomb",infos:"fas fa-info-circle",success:"fas fa-check-circle",bug:"fas fa-bug",mask:"fas fa-mask",back:"fas fa-hand-point-left"};return t[e]||t.mask}var A=function(e){var t=e.type,a=e.className,c=e.onClose,u=e.text,l=Object(n.useState)(r.a.createRef()),i=Object(x.a)(l,1)[0];return r.a.createElement("section",{ref:i,className:"Notif ".concat(a," ").concat(t)},r.a.createElement("p",null,r.a.createElement("i",{className:F(t)}),r.a.createElement("span",null,u)),c instanceof Function&&r.a.createElement("aside",null,r.a.createElement("button",{onClick:function(){return c({ref:i,notif:i.current,remove:function(){i.current.parentNode.removeChild(i.current)}})}},r.a.createElement("i",{className:"fas fa-times"}))))};a(61);var R=function(){return r.a.createElement("p",{className:"sign-in"},"Application front UI/UX d\xe9velopper ",r.a.createElement("span",null,"avec le CRA de Reactjs\xa0"),"par \xa0",r.a.createElement("a",{href:"https://github.com/Orivoir/picsy"},r.a.createElement("i",{className:"fab fa-github"}),"\xa0Samuel Gaborieau"))},U=(a(62),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={loader:r.a.createElement(I,{full:!0,type:"az",width:256,bg:"rgba(0,0,0,.93)"}),u:!1,redirect:!1,pseudo:"",avatar:t.defaultAvatar,errors:[],loaderButton:!1,fileName:""},a.userID=localStorage.getItem("userID")||C.a.getItem("userID"),a.avatarChange=a.avatarChange.bind(Object(p.a)(a)),a.onSubmit=a.onSubmit.bind(Object(p.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.pseudo;if(a.length>=2&&a.length<=40){var n=this.state.avatar;this.setState({loaderButton:r.a.createElement(I,{width:16,type:"btn"})},(function(){t.props.db.users.add({pseudo:a,avatar:n}).then((function(e){var a=e.id;localStorage.setItem("userID",a),C.a.setItem("userID",a),t.setState({redirect:r.a.createElement(N.c,{to:"/dash"})})}))}))}else this.setState((function(e){return{errors:[].concat(Object(l.a)(e.errors),[r.a.createElement(A,{key:Date.now(),text:"pseudo taille invalide",type:"error",onClose:function(e){return(0,e.remove)()}})])}}))}},{key:"avatarChange",value:function(e,t,a){if(e.size<=1e6&&/image/.test(e.type))this.setState({avatar:t,fileName:e.name});else{var n=e.size>=1e6?"fichier trop volumineux":"ce fichier n'est pas une image .";this.setState((function(e){return{errors:[].concat(Object(l.a)(e.errors),[r.a.createElement(A,{key:Date.now(),text:n,type:"error",onClose:function(e){return(0,e.remove)()}})])}}))}}},{key:"componentDidMount",value:function(){var e=this;this.userID?this.props.db.getUser(this.userID).then((function(t){t?e.setState({redirect:r.a.createElement(N.c,{to:"/dash"})}):e.setState({loader:!1})})):this.setState({loader:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loader,n=t.redirect,c=t.avatar,u=t.errors,l=t.loaderButton,i=t.fileName;return r.a.createElement("section",{className:"Logged"},a,n,r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("section",null,r.a.createElement("div",{className:"field-wrap-pseudo"},r.a.createElement("input",{placeholder:"pseudo",type:"text",name:"pseudo",autoComplete:"off",onChange:function(t){return e.setState({pseudo:t.target.value.trim()})},value:this.state.pseudo}),r.a.createElement("label",{htmlFor:"pseudo",className:"o-hide ".concat(this.state.pseudo.trim().length?"active":"")},"pseudo")),r.a.createElement("div",null,r.a.createElement(D,{className:"hide",label:r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"hide micro-system"},i?i.length>7?i.slice(0,7)+" ...":i:"avatar"),r.a.createElement("figure",null,r.a.createElement("button",{type:"button",onClick:function(e){e.target.parentNode.click()}},r.a.createElement("img",{src:c,alt:"avatar",width:64})),r.a.createElement("figcaption",null,"changer"))),name:"avatar",autoRead:!0,onChange:function(t,a,n){return e.avatarChange(t,a,n)}})),r.a.createElement("button",{type:"submit"},l||"suivant")),r.a.createElement(R,null),u.map((function(e){return e}))),r.a.createElement("section",{className:"banner-sm-screen hide"},r.a.createElement("p",null,"Picsy et Lorem dolore veniam culpa velit sint , Anim cupidatat mollit consequat et ipsum ipsum eu ullamco eu ullamco elit non."),r.a.createElement("button",{type:"button"},"get started")))}}]),t}(r.a.Component));U.defaultAvatar="https://image.flaticon.com/icons/png/128/149/149071.png";a(67);var P=a(8),z=a(26),V=a.n(z),L="";var _=function(e){var t=e.u,a=e.load;return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"User"},a||r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,r.a.createElement("strong",null,"Picsy")," application version 0.1.0-beta"),r.a.createElement("div",{className:"content-user"},r.a.createElement("figure",null,r.a.createElement("img",{src:t.get("avatar")||L,alt:"avatar",width:"125"}),r.a.createElement("figcaption",null,t.get("pseudo"))),r.a.createElement(V.a,{id:"user",type:"info",getContent:function(){return r.a.createElement("p",{style:{fontSize:"16px"}},r.a.createElement("i",{className:"fas fa-info-circle"}),"\xa0ajout\xe9 un compte")},effect:"solid",place:"bottom"}),r.a.createElement("p",{"data-for":"user","data-tip":"<em>ajout\xe9</em> un compte"},r.a.createElement(P.HashLink,{to:"/add-account"},r.a.createElement("i",{className:"fas fa-user-plus"})))),r.a.createElement(R,null))))},H=(a(36),a(86),r.a.createRef()),M={confirm:r.a.createRef(),cacel:r.a.createRef()},J={ref:H,confirm:H.current};var T=function(e){var t=e.onConfirm,a=e.onCancel,c=e.onFinally,u=e.textConfirm,l=e.textCancel,i=e.textGlobal,o=e.text,s=e.className,m=e.autoFocus,f=e.autoFocusCancel,d=e.autoFocusConfirm,p=e.icons,b=e.title;return Object(n.useEffect)((function(){f?M.cancel.current.focus():(d||m)&&M.confirm.current.focus()})),r.a.createElement("section",{className:"Confirm ".concat(s),ref:H},b&&r.a.createElement("h2",null,b),r.a.createElement("p",null,i||o),r.a.createElement("aside",null,r.a.createElement("button",{type:"button",className:"confirm",onClick:function(){var e=t instanceof Function?t:function(){},a=c instanceof Function?c:function(){};e(J),a(J)},ref:M.confirm},p&&r.a.createElement("i",{className:"fas fa-check"}),r.a.createElement("span",null,u)),r.a.createElement("button",{className:"cancel",ref:M.cancel,type:"button",onClick:function(){var e=a instanceof Function?a:function(){},t=c instanceof Function?c:function(){};e(J),t(J)}},p&&r.a.createElement("i",{className:"fas fa-times"}),r.a.createElement("span",null,l))))};a(87);var B=function(e){var t=e.manualOpen,a=e.open,c=e.onClose,u=e.onRemove,l=e.onRname,i=e.loadRname,o=e.pic,s=e.errorsRname,m=e.onOpen,f=e.itemType,d=e.closer,p=Object(n.useState)(!1),b=Object(x.a)(p,2),h=b[0],g=b[1],v=Object(n.useState)(!1),E=Object(x.a)(v,2),y=E[0],O=E[1],j=Object(n.useState)(""),S=Object(x.a)(j,2),k=S[0],I=S[1],N=Object(n.useState)(r.a.createRef()),w=Object(x.a)(N,1)[0],C=Object(n.useState)(r.a.createRef()),D=Object(x.a)(C,1)[0];return Object(n.useEffect)((function(){a&&!h&&setTimeout((function(){w.current&&w.current.focus()}),250)})),r.a.createElement("ul",{className:"ControlItem",onMouseEnter:function(){return m()},onMouseLeave:function(){t||c()}},r.a.createElement("li",{className:"".concat(a&&!h?"":"hide")},r.a.createElement("button",{onContextMenu:function(e){return e.preventDefault()},ref:w,className:"".concat(y?"hide":""),onClick:function(){O(!0),setTimeout((function(){return D.current.focus()}),120)}},r.a.createElement("i",{className:"fas fa-pen"})),r.a.createElement("form",{className:"".concat(y?"":"close"),onSubmit:function(e){e.preventDefault(),l(k)}},r.a.createElement("input",{ref:D,className:"input-rname rname ".concat(y?"open":"hide"),type:"text",name:"rname",onChange:function(e){return I(e.target.value)},autoComplete:"off",placeholder:o.get("name"),disabled:!!i}),r.a.createElement("button",{type:"button",onClick:function(){return O(!1)},className:"rname-btn ".concat(y?"":"hide")},i||r.a.createElement("i",{className:"fas fa-times"})),s.map((function(e){return e})))),r.a.createElement("li",{className:"".concat(a&&!y?"":"hide")},h||r.a.createElement("button",{onClick:function(){return g(r.a.createElement(T,{onConfirm:function(){u()},onFinally:function(){return g(!1)},text:"\xeates vous sur de vouloir supprimez l'".concat(f," ").concat(o.get("name")),textConfirm:"oui",textCancel:"non",className:"confirm-remove confirm-remove-picture",icons:!0,autoFocus:!0}))}},r.a.createElement("i",{className:"fas fa-trash"}))),r.a.createElement("li",{className:"".concat(a&&!y&&d&&!h?"":"hide")},r.a.createElement("button",{onClick:function(){return c instanceof Function?c():null}},r.a.createElement("i",{className:"fas fa-times"}))))},K=(a(88),r.a.createRef());var W=function(e){var t=e.item,a=e.db,c=Object(n.useState)(!1),u=Object(x.a)(c,2),i=u[0],o=u[1],s=Object(n.useState)(!1),m=Object(x.a)(s,2),f=m[0],d=m[1],p=Object(n.useState)(!0),b=Object(x.a)(p,2),h=b[0],g=b[1],v=Object(n.useState)(t.get("name")),E=Object(x.a)(v,2),y=E[0],O=E[1],j=Object(n.useState)(!1),S=Object(x.a)(j,2),k=S[0],w=S[1],C=Object(n.useState)(!1),D=Object(x.a)(C,2),F=D[0],R=D[1],U=Object(n.useState)([]),z=Object(x.a)(U,2),V=z[0],L=z[1],_=Object(n.useState)(r.a.createRef()),H=Object(x.a)(_,1)[0];return r.a.createElement(r.a.Fragment,null,F,h&&r.a.createElement("li",{onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},className:"AlbumItem ".concat(h?"":"hide"),ref:H},r.a.createElement("div",{className:"number-item"},t.get("size")," images"),r.a.createElement("button",{className:"album-btn",ref:K,onKeyDown:function(e){/menu/i.test(e.key)&&o(!0),w(!0)},onClick:function(){return R(r.a.createElement(N.c,{to:"album/".concat(t.id)}))},onContextMenu:function(e){return e.preventDefault()}},r.a.createElement(P.HashLink,{onPointerUp:function(e){3===e.nativeEvent.which&&(o(!0),w(!0))},to:"album/".concat(t.id)},y)),r.a.createElement("section",null,r.a.createElement("aside",null,r.a.createElement(B,{itemType:"album",onRemove:function(){a.removeAlbum(t.id).then((function(){g(!1),o(!1)}))},manualOpen:k,onOpen:function(){return o(!0)},onRname:function(e){d(r.a.createElement(I,{width:12,type:"azure"})),a.rnameAlbum(t.id,e).then((function(){L([].concat(Object(l.a)(V),[r.a.createElement(A,{onClose:function(e){return(0,e.remove)()},key:Date.now(),text:"l'album \xe0 \xe9t\xe9 renom\xe9 avec succ\xe9s",type:"success"})])),O(e)}))},loadRname:f,onClose:function(){},pic:t,open:i,errorsRname:V})))))};var Z=function(e){var t=e.albums,a=e.load,n=e.db;return r.a.createElement("ul",{className:"ListAlbums list"},a||(t.length?t.map((function(e){return r.a.createElement(W,{item:e,key:e.id,db:n})})):r.a.createElement(A,{type:"infos",text:"vous n'avez aucun albums"})))},G=(a(89),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={loader:{u:r.a.createElement(I,{width:64,type:"timer",full:!0,bg:"rgba(0,0,0,.9)"}),albums:r.a.createElement(I,{width:64,type:"timer",full:!0,bg:"rgba(0,0,0,.9)"})},u:null,albums:[],redirect:!1},a.userID=localStorage.getItem("userID"),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.userID?this.props.db.getUser(this.userID).then((function(t){t?e.setState((function(e){return{loader:{u:!1,albums:e.loader.albums},u:t}}),(function(){e.props.db.getAlbumsOf(t.id).then((function(t){e.setState((function(e){return{loader:{u:e.loader.u,albums:!1},albums:t}}))}))})):e.setState({loader:{u:!1,albums:!1},redirect:r.a.createElement(N.c,{to:"/"})})})):this.setState({loader:{u:!1,albums:!1},redirect:r.a.createElement(N.c,{to:"/"})})}},{key:"render",value:function(){var e=this.state,t=e.loader,a=e.redirect,n=e.albums,c=e.u;return r.a.createElement("section",{className:"Dash"},a,r.a.createElement(_,{u:c,load:t.u}),r.a.createElement(Z,{db:this.props.db,albums:n,load:t.albums}),r.a.createElement("aside",{className:"add-album"},r.a.createElement("p",null,r.a.createElement(P.HashLink,{to:"/add-album"},r.a.createElement("i",{className:"fas fa-folder-plus"})))))}}]),t}(r.a.Component));a(90);var X=function(e){var t=e.type,a=e.onSubmit,c=e.load,u=e.className,i=e.voidForm,o=Object(n.useState)("https://image0.flaticon.com/icons/png/128/189/189334.png"),s=Object(x.a)(o,2),m=s[0],f=s[1],d=Object(n.useState)([]),p=Object(x.a)(d,2),b=p[0],h=p[1],g=Object(n.useState)(""),v=Object(x.a)(g,2),E=v[0],y=v[1],O=Object(n.useState)(r.a.createRef()),j=Object(x.a)(O,1)[0];return Object(n.useEffect)((function(){i&&(j.current.value="")})),r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:"FormAdd ".concat(u),onSubmit:function(e){e.preventDefault();var n={name:E,picture:m,e:e};/album/i.test(t)&&delete n.picture,a(n)}},r.a.createElement("div",{className:"field-wrap-pseudo"},r.a.createElement("input",{ref:j,type:"text",placeholder:"nom de l'".concat(/album/i.test(t)?"album":"image"),autoComplete:"off",onChange:function(e){var t=e.target;return y(t.value)}}),r.a.createElement("label",{htmlFor:"name",className:"".concat(E.length?"active":"o-hide")},"nom d'",/album/i.test(t)?"album":"image")),/album/i.test(t)?null:r.a.createElement(D,{className:"hide",name:"picture",label:r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{id:"add-picture",type:"info",getContent:function(){return r.a.createElement("p",{style:{fontSize:"16px",margin:0}},r.a.createElement("i",{className:"fas fa-info-circle"}),"\xa0ajout\xe9 une image")},effect:"solid",place:"top"}),r.a.createElement("figure",{"data-tip":"ajout\xe9 une image","data-for":"add-picture"},r.a.createElement("button",{type:"button",onClick:function(e){return e.target.parentNode.click()}},r.a.createElement("img",{src:m,alt:"ajout\xe9",width:64})))),autoRead:!0,onChange:function(e,t,a){if(e.size<=1e6&&/image/i.test(e.type))f(t);else{var n=e.size>1e6?"fichier trop volumineux":"ce fichier n'est pas une image valide";h([].concat(Object(l.a)(b),[r.a.createElement(A,{key:Date.now(),type:"error",text:n,onClose:function(e){return(0,e.remove)()}})]))}}}),r.a.createElement("button",{type:"submit",disabled:!!c},c||r.a.createElement("span",null,"ajout\xe9 l'",/album/i.test(t)?"album":"image"))),b.map((function(e){return e})))},Y=(a(91),function(e){if(!(e instanceof Array))return"";var t="";return e.forEach((function(e){try{var a=null;if(!(a="string"===typeof e?JSON.parse(e):e).key||!a.val)return;/%/.test(a.val)&&/hue/.test(a.key)&&(a.val=a.val.replace("%","deg")),"hueRotate"===a.key&&(a.key="hue-rotate"),t+="".concat(a.key,"(").concat(a.val,") ")}catch(n){}})),console.log(t),t});var q=function(e){var t=e.pics,a=e.load,n=e.figcaption,c=e.width,u=e.classFig;return r.a.createElement("figure",{className:"ImgFilter"},a||r.a.createElement(r.a.Fragment,null,n&&r.a.createElement("figcaption",{className:u},n),r.a.createElement("img",{src:t.get("blob"),alt:t.get("name"),style:{filter:Y(t.get("filters"))},width:c||300})))};a(92);var Q=function(e){var t=e.item,a=e.db,c=e.even,u=Object(n.useState)(!1),i=Object(x.a)(u,2),o=i[0],s=i[1],m=Object(n.useState)(!0),f=Object(x.a)(m,2),d=f[0],p=f[1],b=Object(n.useState)(!1),h=Object(x.a)(b,2),g=h[0],v=h[1],E=Object(n.useState)([]),y=Object(x.a)(E,2),O=y[0],j=y[1],S=Object(n.useState)(r.a.createRef()),k=Object(x.a)(S,1)[0],N=Object(n.useState)(!1),w=Object(x.a)(N,2),C=w[0],D=w[1];return r.a.createElement(r.a.Fragment,null,d&&r.a.createElement("li",{onMouseEnter:function(){return k.current.classList.remove("hide")},onMouseLeave:function(){return k.current.classList.add("hide")},className:"ItemImg ".concat(d?"":"hide"," ").concat(c?"even":"")},r.a.createElement(P.HashLink,{className:"link-filter",to:"/filter/".concat(t.id),onContextMenu:function(e){return e.preventDefault()},onPointerDown:function(e){3===e.nativeEvent.which&&s(!o)},onKeyDown:function(e){/menu/i.test(e.key)&&s(!o)}},r.a.createElement(q,{pics:t,figcaption:r.a.createElement("div",{className:"status-control"},r.a.createElement("button",{ref:k,className:"hide",onClick:function(e){e.preventDefault(),D(!o),s(!o)}},r.a.createElement("i",{class:o?"fas fa-times":"fas fa-ellipsis-v"}))),classFig:"fig-picsy"})),r.a.createElement(B,{closer:!0,itemType:"image",onRemove:function(){a.removePicture(t.id).then((function(){p(!1),s(!1)}))},manualOpen:C,onOpen:function(){return s(!0)},onRname:function(e){v(r.a.createElement(I,{width:12,type:"azure"})),a.rnameImg(t.id,e,t.get("album_id")).then((function(a){v(!1),a.success?j([].concat(Object(l.a)(O),[r.a.createElement(A,{onClose:function(e){return(0,e.remove)()},key:Date.now(),text:"image \xe0 \xe9t\xe9 renom\xe9 avec succ\xe9s",type:"success"})])):401===a.status?j([].concat(Object(l.a)(O),[r.a.createElement(A,{key:Date.now(),type:"error",onClose:function(e){return(0,e.remove)()},text:"l'image ".concat(e," exists d\xe9j\xe0 dans cet album")})])):console.warn("file rname 404 with : ",t.id,t.get("name"))}))},loadRname:g,onClose:function(){s(!1)},pic:t,open:o,errorsRname:O})))};a(93);var $=function(e){var t=e.items,a=e.load,n=e.db;return r.a.createElement("ul",{className:"ListImg"},a||t.map((function(e,t){return r.a.createElement(Q,{key:e.id,item:e,db:n,even:!!(t%2)})})))},ee=(a(94),function(e,t){return new Promise((function(a,n){e.getImgsOf(t).then((function(e){a(e)})).catch((function(e){return n(e)}))}))});var te=function(e){var t=e.db,a=e.loaderAlbum,c=e.album,u=Object(N.m)().id,i=Object(n.useState)(!1),o=Object(x.a)(i,2),s=o[0],m=o[1],f=Object(n.useState)([]),d=Object(x.a)(f,2),p=d[0],b=d[1],h=Object(n.useState)(!1),g=Object(x.a)(h,2),v=g[0],E=g[1],y=Object(n.useState)({pics:!1,loader:r.a.createElement(I,{width:64,bg:"rgba(0,0,0,.9)",type:"timer"})}),O=Object(x.a)(y,2),j=O[0],S=O[1];return r.a.createElement("section",{className:"ShowAlbum"},!a&&r.a.createElement("h2",null,c.get("name")),r.a.createElement($,{items:j.pics?j.pics:ee(t,u).then((function(e){S({pics:e,loader:!1})})),load:j.loader,db:t}),r.a.createElement(X,{type:"picture",voidForm:v,onSubmit:function(e){var a=e.name,n=e.picture;if(a.length<=42&&a.length>=2&&n)m(r.a.createElement(I,{type:"btn",width:16})),t.addPicture(u,a,n).then((function(e){var t=e.success;m(!1),t?(E(!0),setTimeout((function(){E(!1)}),100),S({pics:null,loader:r.a.createElement(I,{width:64,bg:"rgba(0,0,0,.9)",type:"timer"})})):b([].concat(Object(l.a)(p),[r.a.createElement(A,{key:Date.now(),text:"nom d\xe9j\xe0 existant",type:"error",onClose:function(e){return(0,e.remove)()}})]))}));else{var c=n?"taille de nom invalide":"vous n'avez pas envoy\xe9 de fichier";b([].concat(Object(l.a)(p),[r.a.createElement(A,{key:Date.now(),text:c,type:"error",onClose:function(e){return(0,e.remove)()}})]))}},load:s}),p.map((function(e){return e})))},ae=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={loader:r.a.createElement(I,{width:16,type:"btn"}),redirect:!1,loadUser:r.a.createElement(I,{full:!0,width:48,type:"time",bg:"rgba(0,0,0,.9)"}),loaderAlbum:r.a.createElement(I,{full:!0,width:48,type:"az",bg:"rgba(0,0,0,.9)"}),album:null,errors:[]},a.userID=localStorage.getItem("userID")||C.a.getItem("userID"),a.props.action!==t.add()&&a.props.db.albums.doc(document.location.hash.split("/").pop()).get().then((function(e){a.setState({album:e,loaderAlbum:!1})})),a.userID?a.props.db.getUser(a.userID).then((function(e){e?a.setState({loader:!1,user:e,loadUser:!1}):a.setState({loader:!1,redirect:r.a.createElement(N.c,{to:"/"})})})):a.setState({loader:!1,redirect:r.a.createElement(N.c,{to:"/"})}),a}return Object(b.a)(t,e),Object(m.a)(t,null,[{key:"add",value:function(){return"add"}}]),Object(m.a)(t,[{key:"render",value:function(){var e=this,a=this.props.action,n=this.state,c=n.user,u=n.loader,i=n.loadUser,o=n.errors,s=n.formHide,m=n.createWithName,f=n.loaderAlbum,d=n.album;return r.a.createElement(r.a.Fragment,null,r.a.createElement(_,{u:c,load:i}),a===t.add()?r.a.createElement(r.a.Fragment,null,r.a.createElement(X,{load:u,className:"".concat(s?"hide":""),type:"album",onSubmit:function(t){var a=t.name;e.setState({loader:r.a.createElement(I,{width:16,type:"btn"})}),a.length>=2&&a.length<=42?e.props.db.addAlbum(a,c.id).then((function(t){t.success?e.setState({loader:!1,formHide:!0,errors:[],createWithName:a}):e.setState((function(e){return{loader:!1,errors:[].concat(Object(l.a)(e.errors),[r.a.createElement(A,{key:Date.now(),type:"error",onClose:function(e){return(0,e.remove)()},text:"l'album ".concat(a," existe d\xe9j\xe0")})])}}))})):e.setState((function(e){return{errors:[].concat(Object(l.a)(e.errors),[r.a.createElement(A,{key:Date.now(),type:"error",text:"taille de nom invalide",onClose:function(e){return(0,e.remove)()}})]),loader:!1}}))}}),o,s&&r.a.createElement(A,{type:"success",text:r.a.createElement("span",null,"l'album \xa0",r.a.createElement(P.HashLink,{to:"/"},m)," \xe0 \xe9t\xe9 cr\xe9\xe9 avec succ\xe9s")}),r.a.createElement(A,{type:"back",text:r.a.createElement(r.a.Fragment,null,r.a.createElement(P.HashLink,{to:"/dash"},"Tableau de bord"))})):r.a.createElement(r.a.Fragment,null,r.a.createElement(te,{db:this.props.db,loaderAlbum:f,album:d})))}}]),t}(r.a.Component),ne=function(e){function t(){return Object(s.a)(this,t),Object(f.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.blurValue,a=e.onChange,n=e.load,c=e.contrastValue,u=e.grayscaleValue,l=e.hueRotate;return r.a.createElement(r.a.Fragment,null,n||r.a.createElement("form",null,r.a.createElement("div",null,r.a.createElement("label",null,"flootage ",t||0,"%"),r.a.createElement("input",{type:"range",min:"0",max:"100",defaultValue:t||0,onChange:function(e){e.preventDefault(),a({key:"blur",unity:"px",val:parseInt(e.target.value/2)})}})),r.a.createElement("div",null,r.a.createElement("label",null,"contraste ",c||0===c?c:100,"%"),r.a.createElement("input",{type:"range",min:"0",max:"1000",defaultValue:c||0===c?c:100,onChange:function(e){e.preventDefault(),a({key:"contrast",unity:"%",val:parseInt(e.target.value/2)})}})),r.a.createElement("div",null,r.a.createElement("label",null,"grisage ",u||0,"%"),r.a.createElement("input",{type:"range",min:"0",max:"100",defaultValue:u||0,onChange:function(e){e.preventDefault(),a({key:"grayscale",unity:"%",val:parseInt(e.target.value)})}})),r.a.createElement("div",null,r.a.createElement("label",null,"??? ",l||0," degr\xe9s"),r.a.createElement("input",{type:"range",min:"-8000",max:"8000",defaultValue:l||0,onChange:function(e){e.preventDefault(),a({key:"hueRotate",unity:"deg",val:parseInt(e.target.value)})}}))))}}]),t}(r.a.Component),re=(a(95),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={loaderImg:r.a.createElement(I,{width:64,type:"earth",bg:"rgba(0,0,0,.9)"}),loaderUser:r.a.createElement(I,{width:64,type:"timer",bg:"rgba(30,30,42,.95)"}),loaderForm:r.a.createElement(I,{width:48,type:"az",bg:"rgba(30,30,42,.95)"}),user:null,picture:null,redirect:null,blurValue:null,contrastValue:null,grayscaleValue:null,hueRotateValue:null,timeUpdate:20},a.pictureID=document.location.hash.split("/").pop(),a.userID=localStorage.getItem("userID")||C.a.getItem("userID"),a.updatePicture=a.updatePicture.bind(Object(p.a)(a)),a.timeUpdateUp=a.timeUpdateUp.bind(Object(p.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.updateID),clearInterval(this.timeUpdateID)}},{key:"componentDidMount",value:function(){var e=this;this.userID?this.props.db.getUser(this.userID).then((function(t){t?e.setState({u:t,loaderUser:!1},(function(){e.props.db.pictures.doc(e.pictureID).get().then((function(t){e.setState({picture:t,loaderImg:!1,loaderForm:!1,blurValue:2*parseInt((t.get("filters").find((function(e){return"blur"===e.key}))||{}).val),contrastValue:parseInt((t.get("filters").find((function(e){return"contrast"===e.key}))||{}).val),grayscaleValue:parseInt((t.get("filters").find((function(e){return"grayscale"===e.key}))||{}).val),hueRotateValue:parseInt((t.get("filters").find((function(e){return"hue-rotate"===e.key}))||{}).val)},(function(){e.updateID=setInterval(e.updatePicture,2e4),e.timeUpdateID=setInterval(e.timeUpdateUp,1e3)}))})).catch((function(t){e.setState({loaderImg:null,loaderUser:null,redirect:r.a.createElement(N.c,{to:"/"})})}))})):e.setState({loaderImg:null,loaderUser:null,redirect:r.a.createElement(N.c,{to:"/"})})})):this.setState({loaderImg:null,loaderUser:null,redirect:r.a.createElement(N.c,{to:"/"})})}},{key:"timeUpdateUp",value:function(){this.setState((function(e){return{timeUpdate:e.timeUpdate-1>=0?e.timeUpdate-1:0}}))}},{key:"updatePicture",value:function(){var e=this,t=this.state.picture,a=localStorage.getItem("filters-".concat(t.id));try{a=JSON.parse(a)}catch(n){a=[]}finally{a||(a=[])}setTimeout((function(){e.setState({loaderForm:r.a.createElement(I,{width:48,type:"az",bg:"rgba(30,30,42,.95)"})})}),420),this.props.db.pictureSetFilters(t.id,a).then((function(){e.props.db.pictures.doc(e.pictureID).get().then((function(a){e.setState({picture:a,loaderForm:!1,blurValue:2*parseInt((a.get("filters").find((function(e){return"blur"===e.key}))||{}).val),contrastValue:parseInt((a.get("filters").find((function(e){return"contrast"===e.key}))||{}).val),grayscaleValue:parseInt((a.get("filters").find((function(e){return"grayscale"===e.key}))||{}).val),hueRotateValue:parseInt((t.get("filters").find((function(e){return"hue-rotate"===e.key}))||{}).val),timeUpdate:20})}))}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.loaderImg,n=t.loaderUser,c=t.loaderForm,u=t.u,l=t.picture,i=t.blurValue,o=t.contrastValue,s=t.grayscaleValue,m=t.hueRotateValue,f=t.timeUpdate;return r.a.createElement("section",{className:"PictureRoute"},r.a.createElement("header",null,r.a.createElement(_,{u:u,load:n})),r.a.createElement("aside",null,r.a.createElement(q,{load:a,pics:l,classFig:"fig-filter",figcaption:r.a.createElement(r.a.Fragment,null,!a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,l.get("name")),"- ",r.a.createElement("i",null,new Date(l.get("createAt")).toLocaleDateString()))),width:512})),r.a.createElement("p",null,!c&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,"Recalcul de l'image dans ",f),r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){clearInterval(e.updateID),e.updatePicture(),e.updateID=setInterval(e.updatePicture,2e4),e.setState({timeUpdate:20})}},"maintenant"))),r.a.createElement(ne,{load:c,contrastValue:o,blurValue:i,grayscaleValue:s,hueRotate:m,onChange:function(t){var a=t.key,n=t.val,r=t.unity,c=localStorage.getItem("filters-".concat(l.id));try{c=JSON.parse(c)}catch(o){c=[]}finally{c||(c=[])}var u=!1;c=c.map((function(e){return e.key===a&&(e.val=n+r,u=!0),e})),u||c.push({key:a,val:n+r}),localStorage.setItem("filters-".concat(l.id),JSON.stringify(c));var i={};"blur"===a&&(n*=2),i[a+"Value"]=parseInt(n),e.setState(i)}}))}}]),t}(r.a.Component));var ce=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{style:{textAlign:"center",fontWeight:600}},"La fonctionnalit\xe9 d'ajout de compte et actuellement en d\xe9veloppement",r.a.createElement("br",null),"vous pouvez contribuez \xe0\xa0",r.a.createElement("a",{href:"https://github.com/Orivoir/picsy",style:{color:"rgb(75,75,75)"}},r.a.createElement("i",{className:"fab fa-github"}),"Picsy")),r.a.createElement(A,{type:"bug",text:r.a.createElement(r.a.Fragment,null,"page en exp\xe9rimentation\xa0",r.a.createElement("i",{className:"fas fa-vial"}))}),r.a.createElement("br",null),r.a.createElement(A,{type:"infos",text:r.a.createElement(r.a.Fragment,null,"cette fonctionnalit\xe9 sera disponible dans 3 jours ( en gros )")}),r.a.createElement("br",null),r.a.createElement(A,{type:"back",text:r.a.createElement(P.HashLink,{to:"/dash"},"tableau de board")}))},ue=[{id:0,exact:!0,render:U,props:{},path:"/",name:"Home"},{id:1,exact:!1,render:G,props:{},path:"/dash",name:"dashboard"},{id:2,exact:!1,render:ae,props:{action:"add"},path:"/add-album",name:"album add"},{id:3,exact:!1,render:ae,props:{action:"show"},path:"/album/:id",name:"show album"},{id:5,exact:!1,render:re,props:{},path:"/filter/:id",name:"filter album"},{id:6,exact:!1,render:function(e){function t(){return Object(s.a)(this,t),Object(f.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ce,null))}}]),t}(r.a.Component),props:{action:"filter"},path:"/add-account",name:"filter album"}];var le=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.g,null,ue.map((function(e){return r.a.createElement(N.d,{key:e.id,path:e.path,exact:e.exact,render:function(){return r.a.createElement(e.render,Object.assign({},e.props,{db:o}))}})}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ie=a(15);u.a.render(r.a.createElement(ie.HashRouter,null,r.a.createElement(le,null)),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.e7a519dc.chunk.js.map