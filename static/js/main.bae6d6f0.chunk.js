(this.webpackJsonppicsy=this.webpackJsonppicsy||[]).push([[0],Array(27).concat([function(e,t,a){e.exports=a.p+"static/media/loader-timer.8835a88b.svg"},function(e,t,a){e.exports=a.p+"static/media/loader-button.3de4de61.svg"},function(e,t,a){e.exports=a.p+"static/media/loader-azure.df696f68.svg"},,,,,,function(e,t,a){},,,function(e,t,a){e.exports=a.p+"static/media/loader-earth.5f4bc2b1.svg"},,,,,function(e,t,a){e.exports=a(108)},,,,,function(e,t,a){},,,,,,,,,,,,function(e,t,a){},function(e,t,a){},,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,function(e,t,a){},function(e,t,a){},,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(36),o=a.n(c),u=(a(48),a(4)),i=a(23);i.initializeApp({apiKey:"AIzaSyBTZQaxY4tK4wD1CFIAdZYoBNIFNXjpHZI",authDomain:"picsy-827e5.firebaseapp.com",databaseURL:"https://picsy-827e5.firebaseio.com",projectId:"picsy-827e5",storageBucket:"picsy-827e5.appspot.com",messagingSenderId:"228973782937",appId:"1:228973782937:web:8c6a64e32d37e3c8c7d508"});var l={users:i.firestore().collection("users"),albums:i.firestore().collection("albums"),pictures:i.firestore().collection("pictures"),getUser:function(e){var t=this;return new Promise((function(a,n){return t.users.doc(e).get().then((function(e){return a(e.get("pseudo")?e:null)})).catch((function(e){return n(e)}))}))},isLogged:function(e){var t=this;return new Promise((function(a,n){if(!e)return n();t.getUser(e).then((function(e){return a(e?{success:!0,user:e}:{success:!1})})).catch((function(e){return n(e)}))}))},pictureSetFilters:function(e,t){var a=this;return new Promise((function(n,r){a.pictures.doc(e).get().then((function(c){var o=a.pictures.doc(e),i=c.get("filters").filter((function(e){return!t.find((function(t){return t.key===e.key}))}));o.get().then((function(){return o.set({name:c.get("name"),createAt:c.get("createAt"),album_id:c.get("album_id"),filters:[].concat(Object(u.a)(i),Object(u.a)(t)),blob:c.get("blob")}).then((function(){return n({success:!0})})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))}))},pictureSetFilter:function(e,t){var a=this;return new Promise((function(n,r){a.pictures.doc(e).get().then((function(c){var o=c.get("filters"),u=!1,i=o.map((function(e){try{"string"===typeof e&&(e=JSON.parse(e))}catch(a){e={}}return e.key===t.key&&(e.val=t.val,u=!0),e}));u||i.push(JSON.stringify({key:t.key,val:t.val}));var l=a.pictures.doc(e);l.get().then((function(){return l.set({name:c.get("name"),createAt:c.get("createAt"),album_id:c.get("album_id"),filters:i.filter((function(e){try{"string"===typeof e&&(e=JSON.parse(e))}catch(t){return!1}return e.key&&e.val})),blob:c.get("blob")}).then((function(){return n({success:!0})})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))}))},getImgsOf:function(e){var t=this;return new Promise((function(a,n){return t.albums.doc(e).get().then((function(){return t.pictures.get().then((function(t){return a(t.docs.filter((function(t){return t.get("album_id")===e})))})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))},addAlbum:function(e,t){var a=this;return new Promise((function(n,r){e||t||r({status:401}),a.getAlbumsOf(t).then((function(c){if(c.find((function(t){return t.get("name")===e})))return n({success:!1,status:401,details:"already exists"});a.albums.add({user_id:t,name:e,createAt:Date.now(),size:0}).then((function(e){return n({success:!0,album:e})})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))}))},albumUp:function(e){var t=this;return new Promise((function(a,n){var r=t.albums.doc(e);r.get().then((function(e){if(!e.get("createAt"))return n({partial:e});r.set({createAt:e.get("createAt"),name:e.get("name"),size:parseInt(e.get("size"))+1,user_id:e.get("user_id")}).then((function(){return a({success:!0})})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))},albumDown:function(e){var t=this;return new Promise((function(a,n){var r=t.albums.doc(e);r.get().then((function(e){r.set({createAt:e.get("createAt"),name:e.get("name"),size:parseInt(e.get("size"))-1,user_id:e.get("user_id")}).then((function(){return a({success:!0})})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))},getPictureOf:function(e){var t=this;return new Promise((function(a,n){if(!e)return n();t.pictures.get().then((function(t){return a(t.docs.filter((function(t){return t.get("album_id")===e})))}))}))},addPicture:function(e,t,a){var n=this;return new Promise((function(r,c){if(!(e||t||a))return c();n.albums.doc(e).get().then((function(){n.getPictureOf(e).then((function(o){o.find((function(e){return e.get("name")===t}))?r({success:!1,status:401}):n.pictures.add({album_id:e,blob:a,createAt:Date.now(),name:t,filters:[]}).then((function(){n.albumUp(e).then((function(){r({success:!0,id:e,name:t,blob:a})})).catch((function(e){return c(e)}))})).catch((function(e){return c(e)}))}))})).catch((function(e){return c({status:404})}))}))},rnameImg:function(e,t,a){var n=this;return new Promise((function(r,c){e||t||c();var o=n.pictures.doc(e);n.pictures.get().then((function(e){e.docs.find((function(e){return e.get("name")===t&&e.get("album_id")===a}))?r({success:!1,status:401,details:"name already exists"}):o.get().then((function(e){o.set({blob:e.get("blob"),album_id:e.get("album_id"),filters:e.get("filters")||[],name:t,createAt:e.get("createAt")||Date.now()}).then((function(){return r({success:!0})})).catch((function(e){return c(e)}))})).catch((function(e){return r({success:!1,status:404,err:e})}))})).catch((function(){return c()}))}))},rnameAlbum:function(e,t){var a=this;return new Promise((function(n,r){e||t||r();var c=a.albums.doc(e);c.get().then((function(e){e.get("name")===t&&n({success:!0}),c.set({name:t,createAt:e.get("createAt"),size:e.get("size"),user_id:e.get("user_id")}).then((function(){return n({success:!0})}))})).catch((function(e){return r(e)}))}))},getAlbumsOf:function(e){var t=this;return new Promise((function(a,n){return t.albums.get().then((function(t){return a(t.docs.filter((function(t){return t.get("user_id").trim()===e.trim()})))})).catch((function(e){return n(e)}))}))},removePicture:function(e){var t=this;return new Promise((function(a,n){if(!e)return n();var r=t.pictures.doc(e);if(!r||!(r.get instanceof Function))return a({status:404,success:!1});r.get().then((function(e){r.delete().then((function(){t.albumDown(e.get("album_id")).then((function(){a({success:!0})})).catch((function(e){return n(e)}))})).catch((function(){return n()}))}))}))},removeAlbum:function(e){var t=this;return new Promise((function(a,n){e||n({status:401,id:e});var r=t.albums.doc(e);r&&r.get instanceof Function||n({refAlbum:r,id:e,status:404}),r.get().then((function(){r.delete().then((function(){t.getPictureOf(e).then((function(e){e.map((function(e){return t.removePicture(e.id)})),a({success:!0})})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))}},s=a(7),m=a(5),f=a(9),d=a(8),p=a(15),b=a(10),h=(a(60),a(27)),g=a.n(h),v=a(38),E=a.n(v),y=a(28),O=a.n(y),j=a(29),I=a.n(j);function S(e){return{timer:g.a,btn:O.a,button:O.a,earth:E.a,azure:I.a,az:I.a}[e]||g.a}var D=function(e){var t=e.className,a=e.width,n=e.full,c=e.type,o=e.bg;return r.a.createElement("figure",{className:"Loader ".concat(t," ").concat(n?"full":""),style:{backgroundColor:o||"transparent"}},r.a.createElement("img",{alt:"loader ".concat(c),src:S(c),width:a}))},k=a(19),N=a(11),w=a.n(N),C=a(3),x=(a(61),a(39)),F=a.n(x);function A(e){var t={warn:"fas fa-exclamation-triangle",warning:"fas fa-exclamation-triangle",error:"fas fa-bomb",infos:"fas fa-info-circle",info:"fas fa-info-circle",success:"fas fa-check-circle",bug:"fas fa-bug",mask:"fas fa-mask",back:"fas fa-hand-point-left"};return t[e]||t.mask}var R=function(e){var t=e.type,a=e.className,c=e.onClose,o=e.text,u=e.tooltip,i=e.place,l=e.effect,s=Object(n.useState)(r.a.createRef()),m=Object(C.a)(s,1)[0],f=Object(n.useState)(!1),d=Object(C.a)(f,2),p=d[0],b=d[1];return r.a.createElement(r.a.Fragment,null,u?r.a.createElement(F.a,{id:u,type:"infos"===t?"info":"bug"===t?"error":"warn"===t?"warning":t,getContent:function(){return r.a.createElement("span",{style:{fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"space-around"}},r.a.createElement("i",{className:A(t)}),"\xa0",o)},effect:l||"solid",place:i||"top"}):r.a.createElement("section",{ref:m,className:"Notif ".concat(a," ").concat(t," ").concat(p?"hide":"")},r.a.createElement("p",null,r.a.createElement("i",{className:A(t)}),r.a.createElement("span",null,o)),c instanceof Function&&r.a.createElement("aside",null,r.a.createElement("button",{onClick:function(){return c({ref:m,notif:m.current,remove:function(){return m.current instanceof Node&&m.current.parentNode instanceof Node&&(m.current.parentNode.removeChild(m.current),!0)},hide:function(){b(!0)}})}},r.a.createElement("i",{className:"fas fa-times"})))))};var U=function(e){var t=e.className,a=e.label,n=e.name,c=e.id,o=e.onChange,u=e.autoRead,i=e.notif;return r.a.createElement(r.a.Fragment,null,a&&r.a.createElement("label",{htmlFor:c||n},a),r.a.createElement("input",{className:t,type:"file",name:n,id:c||n,onChange:function(e){if(o instanceof Function){var t=e.target.files[0];if(u){var a=null,n=new FileReader,r=e;n.addEventListener("load",(function(e){a=e.target.result,o(t,a,r)})),n.readAsDataURL(t)}else o(t,e)}}}),i)};a(77);var P=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{type:"info",text:"d\xe9pot github",place:"top",tooltip:"git-link"}),r.a.createElement("p",{className:"sign-in"},r.a.createElement("span",null,"Application front UI/UX"),"\xa0d\xe9velopper ",r.a.createElement("span",null,"avec le CRA de Reactjs\xa0"),"par \xa0",r.a.createElement("a",{"data-for":"git-link","data-tip":"lien github",href:"https://github.com/Orivoir/picsy"},r.a.createElement("i",{className:"fab fa-github"}),"\xa0Samuel Gaborieau")))},T=(a(78),function(e){function t(){return Object(s.a)(this,t),Object(f.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onSubmit,a=e.onChangeAvatar,n=e.onChangePseudo,c=e.valuePseudo,o=e.fileName,u=e.avatar,i=e.loaderSubmit,l=e.errors;return r.a.createElement("form",{className:"FormUser",onSubmit:t},r.a.createElement("section",null,r.a.createElement("div",{className:"field-wrap-pseudo"},r.a.createElement("input",{placeholder:"pseudo",type:"text",name:"pseudo",autoComplete:"off",onChange:n,value:c}),r.a.createElement("label",{htmlFor:"pseudo",className:"o-hide ".concat(c.trim().length?"active":"")},"pseudo")),r.a.createElement("div",null,r.a.createElement(U,{className:"hide",label:r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"hide micro-system"},o?o.length>7?o.slice(0,7)+" ...":o:"avatar"),r.a.createElement("figure",null,r.a.createElement("button",{type:"button",onClick:function(e){e.target.parentNode.click()}},r.a.createElement("img",{src:u,alt:"avatar",width:64})),r.a.createElement("figcaption",null,"changer"))),name:"avatar",autoRead:!0,onChange:a})),r.a.createElement("button",{type:"submit"},i||"suivant")),r.a.createElement(P,null),l.map((function(e){return e})))}}]),t}(r.a.Component)),L=(a(79),function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={loader:r.a.createElement(D,{full:!0,type:"az",width:256,bg:"rgba(0,0,0,.93)"}),u:!1,redirect:!1,pseudo:"",avatar:t.defaultAvatar,errors:[],loaderButton:!1,fileName:""},a.userID=localStorage.getItem("userID")||w.a.getItem("userID");try{a.userID=JSON.parse(a.userID)}catch(n){a.userID=[]}return a.avatarChange=a.avatarChange.bind(Object(p.a)(a)),a.onSubmit=a.onSubmit.bind(Object(p.a)(a)),document.title="Picsy | Log in",a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.pseudo;if(a.length>=2&&a.length<=40){var n=this.state.avatar;this.setState({loaderButton:r.a.createElement(D,{width:16,type:"btn"})},(function(){t.props.db.users.add({pseudo:a,avatar:n}).then((function(e){t.userID||(t.userID=[]),t.userID.push(e.id),localStorage.setItem("userID",JSON.stringify(t.userID)),w.a.setItem("userID",JSON.stringify(t.userID),new Date(1.5*Date.now())),t.setState({redirect:r.a.createElement(k.c,{to:"/account-list"})})}))}))}else this.setState((function(e){return{errors:[].concat(Object(u.a)(e.errors),[r.a.createElement(R,{key:Date.now(),text:"pseudo taille invalide",type:"error",onClose:function(e){return(0,e.remove)()}})])}}))}},{key:"avatarChange",value:function(e,t,a){if(e.size<=1e6&&/image/.test(e.type))this.setState({avatar:t,fileName:e.name});else{var n=e.size>=1e6?"fichier trop volumineux":"ce fichier n'est pas une image .";this.setState((function(e){return{errors:[].concat(Object(u.a)(e.errors),[r.a.createElement(R,{key:Date.now(),text:n,type:"error",onClose:function(e){return(0,e.remove)()}})])}}))}}},{key:"componentDidMount",value:function(){this.userID&&this.userID.length?this.setState({redirect:r.a.createElement(k.c,{to:"/account-list"})}):this.setState({loader:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loader,n=t.redirect,c=t.avatar,o=t.errors,u=t.loaderButton,i=t.fileName;return r.a.createElement("section",{className:"Logged"},a,n,r.a.createElement(T,{onSubmit:this.onSubmit,onChangePseudo:function(t){return e.setState({pseudo:t.target.value.trim()})},avatar:c,valuePseudo:this.state.pseudo,fileName:i,errors:o,loaderSubmit:u,onChangeAvatar:function(t,a,n){return e.avatarChange(t,a,n)}}),r.a.createElement("section",{className:"banner-sm-screen hide"},r.a.createElement("p",null,"Picsy et Lorem dolore veniam culpa velit sint , Anim cupidatat mollit consequat et ipsum ipsum eu ullamco eu ullamco elit non."),r.a.createElement("button",{type:"button"},"get started")))}}]),t}(r.a.Component));L.defaultAvatar="https://image.flaticon.com/icons/png/128/149/149071.png";a(84),a(85);var z=function(e){var t=e.title,a=e.subtitle,n=e.className;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:n},t),a&&r.a.createElement("blockquote",null,a))},M=a(14);var V=function(e){var t=e.tooltip,a=e.className,c=e.target,o=e.onClick,u=e.classHandle,i=e.loader,l=e.textAlt,s=e.text,m=e.alt,f=Object(n.useState)(!1),d=Object(C.a)(f,2),p=d[0],b=d[1],h=Object(n.useState)(!1),g=Object(C.a)(h,2),v=g[0],E=g[1];return r.a.createElement(r.a.Fragment,null,t,r.a.createElement("span",{"data-for":t.props.tooltip,id:t.props.tooltip,"data-tip":t.props.text},v,c?r.a.createElement(M.HashLink,{style:{transition:".11s linear all"},onFocus:function(){b(!0)},onBlur:function(){b(!1)},to:c,onPointerDown:o instanceof Function?o:function(){E(r.a.createElement(k.c,{to:c}))},className:"".concat(u," ").concat(p?"access-focus":"")},i||(p?l||s||m||"here":r.a.createElement("i",{className:a}))):r.a.createElement("button",{type:"button",className:u,onClick:o instanceof Function?o:function(){}},i||(p?l||s||m||"here":r.a.createElement("i",{className:a})))))},_={User:[{id:0,alt:"ajout\xe9 compte",tooltip:r.a.createElement(R,{type:"info",place:"bottom",tooltip:"user",text:"ajout\xe9 un compte"}),target:"/add-account",className:"fas fa-user-plus"},{id:1,alt:"chang\xe9 compte",tooltip:r.a.createElement(R,{type:"info",place:"bottom",tooltip:"change",text:"chang\xe9 de compte"}),target:"/account-list",className:"fas fa-person-booth"}],ChangeAlign:[{id:0,alt:"gallerie alignement",tooltip:r.a.createElement(R,{type:"info",place:"top",tooltip:"gallery",text:"gallerie alignement"}),className:"fas fa-th",onClick:function(e){return e(!1)}},{id:1,alt:"diaporama alignement",tooltip:r.a.createElement(R,{type:"info",place:"top",tooltip:"slider",text:"diaporama alignement"}),className:"fas fa-sliders-h",onClick:function(e){return e(!0)}}]},H=_.User,J=_.ChangeAlign;var B=function(e){var t=e.u,a=e.load;return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"User"},a||r.a.createElement(r.a.Fragment,null,r.a.createElement(z,{title:r.a.createElement(r.a.Fragment,null,r.a.createElement("strong",null,"Picsy")," application"),subtitle:"version 0.2.3-beta"}),r.a.createElement("div",{className:"content-user"},r.a.createElement("figure",null,r.a.createElement("img",{src:t.get("avatar"),alt:"avatar",width:"125"}),r.a.createElement("figcaption",null,t.get("pseudo"))),H.map((function(e){return r.a.createElement(V,{alt:e.alt,key:e.id,tooltip:e.tooltip,target:e.target,className:e.className})}))),r.a.createElement(P,null))))},K=(a(35),a(89),r.a.createRef()),Z={confirm:r.a.createRef(),cacel:r.a.createRef()},q={ref:K,confirm:K.current};var G=function(e){var t=e.onConfirm,a=e.onCancel,c=e.onFinally,o=e.textConfirm,u=e.textCancel,i=e.textGlobal,l=e.text,s=e.className,m=e.autoFocus,f=e.autoFocusCancel,d=e.autoFocusConfirm,p=e.icons,b=e.title;return Object(n.useEffect)((function(){f?Z.cancel.current.focus():(d||m)&&Z.confirm.current.focus()})),r.a.createElement("section",{className:"Confirm ".concat(s),ref:K},b&&r.a.createElement("h2",null,b),r.a.createElement("p",null,i||l),r.a.createElement("aside",null,r.a.createElement("button",{type:"button",className:"confirm",onClick:function(){var e=t instanceof Function?t:function(){},a=c instanceof Function?c:function(){};e(q),a(q)},ref:Z.confirm},p&&r.a.createElement("i",{className:"fas fa-check"}),r.a.createElement("span",null,o)),r.a.createElement("button",{className:"cancel",ref:Z.cancel,type:"button",onClick:function(){var e=a instanceof Function?a:function(){},t=c instanceof Function?c:function(){};e(q),t(q)}},p&&r.a.createElement("i",{className:"fas fa-times"}),r.a.createElement("span",null,u))))};a(90);var W=function(e){var t=e.manualOpen,a=e.open,c=e.onClose,o=e.onRemove,u=e.onRname,i=e.loadRname,l=e.pic,s=e.errorsRname,m=e.onOpen,f=e.itemType,d=e.closer,p=e.tipRemove,b=Object(n.useState)(!1),h=Object(C.a)(b,2),g=h[0],v=h[1],E=Object(n.useState)(!1),y=Object(C.a)(E,2),O=y[0],j=y[1],I=Object(n.useState)(""),S=Object(C.a)(I,2),D=S[0],k=S[1],N=Object(n.useState)(r.a.createRef()),w=Object(C.a)(N,1)[0],x=Object(n.useState)(r.a.createRef()),F=Object(C.a)(x,1)[0];return Object(n.useEffect)((function(){a&&!g&&setTimeout((function(){w.current&&w.current.focus()}),250)})),r.a.createElement("ul",{className:"ControlItem",onMouseEnter:function(){return m instanceof Function?m():null},onMouseLeave:function(){!t&&c instanceof Function&&c()}},r.a.createElement("li",{className:"".concat(a&&!g?"":"hide")},r.a.createElement(V,{tooltip:r.a.createElement(R,{type:"info",place:"top",tooltip:"rname-".concat(Date.now()),text:r.a.createElement(r.a.Fragment,null,"renom\xe9 l'","album"!==f?"image":"album")}),className:"fas fa-pen",onClick:function(){j(!0),setTimeout((function(){return F.current.focus()}),120)},classHandle:"".concat(O?"hide":"")}),r.a.createElement("form",{className:"".concat(O?"":"close"),onSubmit:function(e){e.preventDefault(),u(D),k("")}},r.a.createElement("input",{ref:F,className:"input-rname rname ".concat(O?"open":"hide"," ").concat(i?"load-input":""),type:"text",name:"rname",value:D,onChange:function(e){return k(e.target.value)},autoComplete:"off",placeholder:l.get("name"),disabled:!!i}),r.a.createElement(V,{tooltip:r.a.createElement(R,{type:"info",place:"top",tooltip:"back",text:"ferm\xe9"}),loader:i,className:"fas fa-times",onClick:function(){return j(!1)},classHandle:"rname-btn ".concat(O?"":"hide"," ").concat(i?"load-btn disabled":"")}),s.map((function(e){return e})))),r.a.createElement("li",{className:"".concat(a&&!O?"":"hide")},g||r.a.createElement(r.a.Fragment,null,r.a.createElement(V,{tooltip:r.a.createElement(R,{type:"info",place:"top",tooltip:"remove",text:r.a.createElement(r.a.Fragment,null,p||r.a.createElement(r.a.Fragment,null,"supprim\xe9 l'","album"!==f?"image":"album"))}),className:"fas fa-trash",onClick:function(){return v(r.a.createElement(G,{onConfirm:o,onFinally:function(){return v(!1)},text:"\xeates vous sur de vouloir supprimez l'".concat(f," ").concat(l.get("name")),textConfirm:"oui",textCancel:"non",className:"confirm-remove confirm-remove-picture",icons:!0,autoFocus:!0}))}}))),r.a.createElement("li",{className:"".concat(a&&!O&&d&&!g?"":"hide")},r.a.createElement(V,{tooltip:r.a.createElement(R,{type:"info",place:"top",tooltip:"close",text:"f\xe9rmer le menu"}),className:"fas fa-times",onClick:function(){return c instanceof Function?c():null}})))},X=(a(91),r.a.createRef());var Y=function(e){var t=e.item,a=e.db,c=Object(n.useState)(!1),o=Object(C.a)(c,2),i=o[0],l=o[1],s=Object(n.useState)(!1),m=Object(C.a)(s,2),f=m[0],d=m[1],p=Object(n.useState)(!0),b=Object(C.a)(p,2),h=b[0],g=b[1],v=Object(n.useState)(t.get("name")),E=Object(C.a)(v,2),y=E[0],O=E[1],j=Object(n.useState)(!1),I=Object(C.a)(j,2),S=I[0],N=I[1],w=Object(n.useState)(!1),x=Object(C.a)(w,2),F=x[0],A=x[1],U=Object(n.useState)([]),P=Object(C.a)(U,2),T=P[0],L=P[1],z=Object(n.useState)(r.a.createRef()),V=Object(C.a)(z,1)[0],_=Object(n.useState)(null),H=Object(C.a)(_,2),J=H[0],B=H[1];return Object(n.useEffect)((function(){null===J&&function(e,t){return new Promise((function(a,n){t.getPictureOf(e).then((function(e){return a(e.length)}))}))}(t.id,a).then((function(e){return B(e||0)}))})),r.a.createElement(r.a.Fragment,null,F,h&&r.a.createElement("li",{onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)},className:"AlbumItem ".concat(h?"":"hide"),ref:V},r.a.createElement("div",{className:"number-item"},null===J?r.a.createElement(D,{width:32,type:"az"}):J," images"),r.a.createElement("button",{className:"album-btn",ref:X,onKeyDown:function(e){/menu/i.test(e.key)&&l(!i),N(!i)},onClick:function(){return A(r.a.createElement(k.c,{to:"album/".concat(t.id)}))},onContextMenu:function(e){return e.preventDefault()}},r.a.createElement(M.HashLink,{onPointerUp:function(e){3===e.nativeEvent.which&&(l(!0),N(!0))},to:"album/".concat(t.id)},y)),r.a.createElement("section",null,r.a.createElement("aside",null,r.a.createElement(W,{tipRemove:"abc",itemType:"album",onRemove:function(){a.removeAlbum(t.id).then((function(){g(!1),l(!1)}))},manualOpen:S,onOpen:function(){return l(!0)},onRname:function(e){d(r.a.createElement(D,{width:12,type:"azure"})),a.rnameAlbum(t.id,e).then((function(){L([].concat(Object(u.a)(T),[r.a.createElement(R,{onClose:function(e){return(0,e.remove)()},key:Date.now(),text:"l'album \xe0 \xe9t\xe9 renom\xe9 avec succ\xe9s",type:"success"})])),O(e)}))},loadRname:f,onClose:function(){},pic:t,open:i,errorsRname:T})))))};var Q=function(e){var t=e.albums,a=e.load,n=e.db;return e.onChangeAlbums,r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"ListAlbums list"},a||(t.length?r.a.createElement(r.a.Fragment,null,t.map((function(e){return r.a.createElement(Y,{item:e,key:e.id,db:n})}))):r.a.createElement(R,{type:"infos",text:"vous n'avez aucun albums"}))))},$=(a(92),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={loader:{u:r.a.createElement(D,{width:64,type:"timer",full:!0,bg:"rgba(0,0,0,.9)"}),albums:r.a.createElement(D,{width:64,type:"timer",full:!0,bg:"rgba(0,0,0,.9)"})},u:null,albums:[],redirect:!1},a.userID=localStorage.getItem("useID")||w.a.getItem("useID"),document.title="Picsy | Dash",a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.userID?this.getAlbums():this.setState({redirect:r.a.createElement(k.c,{to:"/"})})}},{key:"getAlbums",value:function(){var e=this;this.props.db.getUser(this.userID).then((function(t){t?e.setState((function(e){return{loader:{u:!1,albums:e.loader.albums},u:t}}),(function(){e.props.db.getAlbumsOf(t.id).then((function(t){e.setState({loader:{albums:!1},albums:t})}))})):e.setState({redirect:r.a.createElement(k.c,{to:"/"})})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.loader,n=t.redirect,c=t.albums,o=t.u;return r.a.createElement("section",{className:"Dash"},n,r.a.createElement(B,{u:o,load:a.u}),r.a.createElement(Q,{db:this.props.db,albums:c,load:a.albums,onChangeAlbums:function(){return e.getAlbums()}}),r.a.createElement("aside",{className:"add-album"},r.a.createElement(V,{alt:"ajout\xe9 album",tooltip:r.a.createElement(R,{tooltip:"add-album",type:"infos",text:"cr\xe9\xe9 un album",place:"top"}),className:"fas fa-folder-plus",target:"/add-album"})))}}]),t}(r.a.Component)),ee=(a(93),"https://image0.flaticon.com/icons/png/128/189/189334.png");var te=function(e){var t=e.type,a=e.onSubmit,c=e.load,o=e.className,i=e.onChange,l=e.imgsLength,s=e.autoFocus,m=Object(n.useState)(""),f=Object(C.a)(m,2),d=f[0],p=f[1],b=Object(n.useState)([]),h=Object(C.a)(b,2),g=h[0],v=h[1],E=Object(n.useState)(""),y=Object(C.a)(E,2),O=y[0],j=y[1],I=Object(n.useState)(r.a.createRef()),S=Object(C.a)(I,1)[0];return Object(n.useEffect)((function(){S.current instanceof Node&&s&&S.current.focus()})),r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:"FormAdd ".concat(o),onSubmit:function(e){e.preventDefault();var n={name:O,picture:d||ee,refName:S,e:e};j(""),/album/i.test(t)&&delete n.picture,a(n)}},r.a.createElement("div",{className:"field-wrap-pseudo"},r.a.createElement("input",{ref:S,type:"text",value:O,placeholder:"nom de l'".concat(/album/i.test(t)?"album":"image"),autoComplete:"off",onChange:function(e){var t=e.target;return j(t.value)}}),r.a.createElement("label",{htmlFor:"name",className:"".concat(O.length?"active":"o-hide")},"nom d'",/album/i.test(t)?"album":"image")),/album/i.test(t)?null:r.a.createElement(U,{className:"hide",name:"picture",label:r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{tooltip:"add-picture",type:"info",text:"ajout\xe9 une image",place:"top"}),r.a.createElement("figure",{"data-tip":"ajout\xe9 une image","data-for":"add-picture"},r.a.createElement("button",{type:"button",onClick:function(e){return e.target.parentNode.click()}},r.a.createElement("img",{src:ee,alt:"ajout\xe9",width:64})))),autoRead:!0,onChange:function(e,t,a){if(e.size<=1e6&&/image/i.test(e.type))p(t),function(a){j(""),a(e,t,O,S)}(i instanceof Function?i:function(){});else{var n=e.size>1e6?"fichier trop volumineux":"ce fichier n'est pas une image valide";v([].concat(Object(u.a)(g),[r.a.createElement(R,{key:Date.now(),type:"error",text:n,onClose:function(e){return(0,e.remove)()}})]))}}}),r.a.createElement(R,{tooltip:"disabled",type:"warn",text:"chargement ..."}),r.a.createElement("button",{type:"submit",disabled:!!c,className:c?"disabled":"","data-for":c?"disabled":"","data-tip":"chargement ..."},c||r.a.createElement("span",null,"ajout\xe9 ",/album/i.test(t)?"'album":l+" images"))),g.map((function(e){return e})))},ae=(a(94),function(e){if(!(e instanceof Array))return"";var t="";return e.forEach((function(e){try{var a=null;if(!(a="string"===typeof e?JSON.parse(e):e).key||!a.val)return;/%/.test(a.val)&&/hue/.test(a.key)&&(a.val=a.val.replace("%","deg")),"hueRotate"===a.key&&(a.key="hue-rotate"),t+="".concat(a.key,"(").concat(a.val,") ")}catch(n){}})),t});var ne=function(e){var t=e.pics,a=e.load,n=e.figcaption,c=e.width,o=e.classFig;return r.a.createElement("figure",{className:"ImgFilter"},a||r.a.createElement(r.a.Fragment,null,n&&r.a.createElement("figcaption",{className:o},n),r.a.createElement("img",{src:t.get("blob"),alt:t.get("name"),style:{filter:ae(t.get("filters"))},width:c||300})))};a(95);var re=function(e){var t=e.item,a=e.db,c=e.even,o=Object(n.useState)(!1),i=Object(C.a)(o,2),l=i[0],s=i[1],m=Object(n.useState)(!0),f=Object(C.a)(m,2),d=f[0],p=f[1],b=Object(n.useState)(!1),h=Object(C.a)(b,2),g=h[0],v=h[1],E=Object(n.useState)([]),y=Object(C.a)(E,2),O=y[0],j=y[1],I=Object(n.useState)(r.a.createRef()),S=Object(C.a)(I,1)[0],k=Object(n.useState)(!1),N=Object(C.a)(k,2),w=N[0],x=N[1];return r.a.createElement(r.a.Fragment,null,d&&r.a.createElement("li",{onMouseEnter:function(){return S.current.classList.remove("hide")},onMouseLeave:function(){return S.current.classList.add("hide")},className:"ItemImg ".concat(d?"":"hide"," ").concat(c?"even":"")},r.a.createElement(M.HashLink,{className:"link-filter",to:"/filter/".concat(t.id),onContextMenu:function(e){return e.preventDefault()},onPointerDown:function(e){3===e.nativeEvent.which&&s(!l)},onKeyDown:function(e){/menu/i.test(e.key)&&s(!l)}},r.a.createElement(R,{tooltip:"nav",type:"info",text:"".concat(l?"fermer":"ouvrir"," menu"),place:"top"}),r.a.createElement(ne,{pics:t,figcaption:r.a.createElement("div",{"data-for":"nav","data-tip":"menu",className:"status-control"},r.a.createElement("button",{ref:S,className:"hide",onClick:function(e){e.preventDefault(),x(!l),s(!l)}},r.a.createElement("i",{className:l?"fas fa-times":"fas fa-ellipsis-v"}))),classFig:"fig-picsy"})),r.a.createElement(W,{closer:!0,itemType:"image",onRemove:function(){a.removePicture(t.id).then((function(){p(!1),s(!1)}))},manualOpen:w,onOpen:function(){return s(!0)},onRname:function(e){v(r.a.createElement(D,{width:12,type:"azure"})),a.rnameImg(t.id,e,t.get("album_id")).then((function(a){v(!1),a.success?j([].concat(Object(u.a)(O),[r.a.createElement(R,{onClose:function(e){return(0,e.remove)()},key:Date.now(),text:"image \xe0 \xe9t\xe9 renom\xe9 avec succ\xe9s",type:"success"})])):401===a.status?j([].concat(Object(u.a)(O),[r.a.createElement(R,{key:Date.now(),type:"error",onClose:function(e){return(0,e.remove)()},text:"l'image ".concat(e," exists d\xe9j\xe0 dans cet album")})])):console.warn("file rname 404 with : ",t.id,t.get("name"))}))},loadRname:g,onClose:function(){s(!1)},pic:t,open:l,errorsRname:O})))};a(96),a(97);var ce=function(e){var t=e.setter,a=e.status;return r.a.createElement("section",{className:"ChangeAlign"},J.map((function(e){return r.a.createElement(V,{alt:e.alt,key:e.id,tooltip:e.tooltip,className:e.className,onClick:function(){return e.onClick(t)},classHandle:"".concat(a&&e.id?"active":a||e.id?"":"active"," ")})})))};a(98);var oe=function(e){var t=e.id,a=e.img,n=e.active,c=e.slide;return r.a.createElement("section",{className:"Slide ".concat(n===t?"active":"hide"," ").concat(c," ")},a)},ue=(a(99),a(42)),ie=(a(100),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={active:0,slide:null,percent:0,over:!1},a.state.size=e.imgs.length,e.imgs.length||console.error("Slider props imgs error because is not an iterable : ",e.imgs),a.startTimeout="number"===typeof e.timeout&&e.timeout>t.SLIDER_TIMEOUT?e.timeout:3e3,a.currentTimeout=a.startTimeout,a.next=a.next.bind(Object(p.a)(a)),a.percentUpdate=a.percentUpdate.bind(Object(p.a)(a)),a.inTransition=!1,a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"percentUpdate",value:function(){this.currentTimeout-=50;var e=(this.startTimeout-this.currentTimeout)/this.startTimeout*100;e>100?this.next():this.setState({percent:Math.floor(e)})}},{key:"next",value:function(){var e=this;this.inTransition=!0;var a=this.state,n=a.active,r=a.size,c=a.over,o=n+1<r?n+1:0;this.setState({slide:"next"},(function(){clearInterval(e.percentID),setTimeout((function(){e.setState({slide:null,active:o,percent:0},(function(){setTimeout((function(){c||(e.percentID=setInterval(e.percentUpdate,50)),e.inTransition=!1,e.endTransit instanceof Function&&(e.endTransit(),e.endTransit=null)}),t.SLIDER_TIMEOUT),e.currentTimeout=e.startTimeout}))}),t.SLIDER_TIMEOUT)}))}},{key:"prev",value:function(){var e=this;this.inTransition=!0;var a=this.state,n=a.active,r=a.size,c=a.over,o=n-1>=0?n-1:r-1;this.setState({slide:"prev"},(function(){clearInterval(e.percentID),setTimeout((function(){e.setState({slide:null,active:o,percent:0},(function(){setTimeout((function(){c||(e.percentID=setInterval(e.percentUpdate,50)),e.inTransition=!1,e.endTransit instanceof Function&&(e.endTransit(),e.endTransit=null)}),t.SLIDER_TIMEOUT),e.currentTimeout=e.startTimeout}))}),t.SLIDER_TIMEOUT)}))}},{key:"componentDidMount",value:function(){this.percentID=setInterval(this.percentUpdate,50)}},{key:"componentWillUnmount",value:function(){clearInterval(this.percentID)}},{key:"render",value:function(){var e=this,t=this.props.imgs,a=this.state,n=a.active,c=a.slide,o=a.percent,u=a.over;return r.a.createElement("div",{className:"Slider",onMouseEnter:function(){clearInterval(e.percentID),e.setState({over:!0})},onMouseLeave:function(){clearInterval(e.percentID),e.inTransition?e.endTransit=function(){e.percentID=setInterval(e.percentUpdate,50)}:e.percentID=setInterval(e.percentUpdate,50),e.setState({over:!1})}},r.a.createElement("div",{className:"points-item"},t.map((function(t,a){return r.a.createElement("span",{className:"points ".concat(a===n?"active":""),key:a,onClick:function(){a!==n&&(e.currentTimeout=e.startTimeout,e.setState({active:a,percent:0}))}})}))),r.a.createElement(ue.Progress,{percent:o,status:o<100?"active":"success",theme:{active:{symbol:o,color:"#e166b5"}}}),r.a.createElement("section",{className:"content-slider"},r.a.createElement("button",{type:"button",className:"".concat(u?"":"o-hide"),onClick:function(){clearInterval(e.percentID),e.prev()}},r.a.createElement("i",{className:"fas fa-arrow-left"})),t.map((function(e,t){return r.a.createElement(oe,{key:t,img:e,active:n,id:t,slide:c})})),r.a.createElement("button",{type:"button",className:"".concat(u?"":"o-hide"),onClick:function(){clearInterval(e.percentID),e.next()}},r.a.createElement("i",{className:"fas fa-arrow-right"}))))}}]),t}(r.a.Component));function le(e,t){return{key:e.id,item:e,db:t}}ie.SLIDER_TIMEOUT=500;var se=function(e){var t=e.items,a=e.load,c=e.db,o=Object(n.useState)(!1),u=Object(C.a)(o,2),i=u[0],l=u[1];return r.a.createElement("section",null,r.a.createElement("ul",{className:"ListImg"},a||r.a.createElement(r.a.Fragment,null,i?r.a.createElement(ie,{timeout:5e3,imgs:t.map((function(e){return r.a.createElement(re,le(e,c))}))}):t.map((function(e){return r.a.createElement(re,le(e,c))})))),r.a.createElement(ce,{setter:l,status:i}))};a(101);var me=function(e){var t=e.item,a=e.onRemove,c=e.onRname,o=Object(n.useState)(!1),u=Object(C.a)(o,2),i=u[0],l=u[1];return r.a.createElement("li",null,r.a.createElement("figure",null,r.a.createElement("img",{src:t.blob,alt:"pr\xe9 vue d'ajout",width:128}),r.a.createElement("figcaption",null,t.name),r.a.createElement(W,{onRemove:a,onRname:function(e,a){l(r.a.createElement(D,{type:"btn",width:24})),setTimeout((function(){l(!1)}),Math.round(95*Math.random())+150),c(t.name,e)},open:!0,pic:{get:function(e){return"name"===e?t.name:t.blob}},loadRname:i,errorsRname:[],tipRemove:"supprim\xe9 de l'ajout",itemType:"image"})))};var fe=function(e){var t=e.items,a=e.error,n=e.onRemove,c=e.onRname;return r.a.createElement("ul",{className:"".concat(a?"error":""," Previews")},t.map((function(e,t){return r.a.createElement(me,{onRname:function(e,t){return c(e,t)},key:t,item:e,onRemove:n})})))},de=(a(102),function(e,t){return new Promise((function(a,n){e.getImgsOf(t).then((function(e){a(e)})).catch((function(e){return n(e)}))}))});var pe=function(e){var t=e.db,a=e.loaderAlbum,c=e.album,o=Object(k.m)().id,i=Object(n.useState)(!1),l=Object(C.a)(i,2),s=l[0],m=l[1],f=Object(n.useState)([]),d=Object(C.a)(f,2),p=d[0],b=d[1],h=Object(n.useState)([]),g=Object(C.a)(h,2),v=g[0],E=g[1],y=Object(n.useState)([]),O=Object(C.a)(y,2),j=O[0],I=O[1],S=Object(n.useState)({pics:!1,loader:r.a.createElement(D,{width:64,bg:"rgba(0,0,0,.9)",type:"timer"})}),N=Object(C.a)(S,2),w=N[0],x=N[1];return r.a.createElement("section",{className:"ShowAlbum"},!a&&r.a.createElement("h2",null,c.get("name")),r.a.createElement(se,{items:w.pics?w.pics:de(t,o).then((function(e){x({pics:e,loader:!1})})),load:w.loader,db:t}),r.a.createElement(te,{type:"picture",onSubmit:function(){s||(j.length?(m(r.a.createElement(D,{type:"btn",width:16})),Promise.all(Array.from(Array(j.filter((function(e){return e.name.length>=2&&e.name.length<42})).length).keys()).map((function(e){return t.addPicture(o,j[e].name,j[e].blob)}))).then((function(e){var t=[],a=j,n=p;e.forEach((function(e){e.success?(a=a.filter((function(t){return t.name!==e.name})),t.push(e.name)):401===e.status?n.push(r.a.createElement(R,{key:Date.now(),text:"".concat(e.name," existe d\xe9j\xe0 "),type:"error",onClose:function(e){return(0,e.remove)()}})):(n.push(r.a.createElement(R,{key:Date.now(),text:"une erreur de r\xe9seaux et survenue , check README.md ERROR_CODE[10b2] branch => v0.2.2-beta",type:"error",onClose:function(e){return(0,e.remove)()}})),console.error("unknow error in add image response : ",e))})),E(t||[]),b(n),I(a),m(!1),x({pics:!1,loader:r.a.createElement(D,{width:64,bg:"rgba(0,0,0,.9)",type:"timer"})})})).catch((function(e){m(!1),console.error(e)}))):b([].concat(Object(u.a)(p),[r.a.createElement(R,{key:Date.now(),text:"vous n'avez pas envoy\xe9 de fichier",type:"error",onClose:function(e){return(0,e.remove)()}})])))},onChange:function(e,t,a){a.length<2||a.length>=42?b([].concat(Object(u.a)(p),[r.a.createElement(R,{key:Date.now(),text:"taille de nom invalide",type:"error",onClose:function(e){return(0,e.remove)()}})])):j.find((function(e){return e.name===a}))?b([].concat(Object(u.a)(p),[r.a.createElement(R,{key:Date.now(),text:"ce nom d'image \xe9xiste d\xe9j\xe0",type:"error",onClose:function(e){return(0,e.remove)()}})])):j.length>=3?b([].concat(Object(u.a)(p),[r.a.createElement(R,{key:Date.now(),text:"Vous ne pouvez pas ajout\xe9 plus d'images en 1 seule fois .",type:"error",onClose:function(e){return(0,e.remove)()}})])):I([].concat(Object(u.a)(j),[{blob:t,name:a}]))},load:s,imgsLength:j.length}),p.map((function(e){return e})),j.length?r.a.createElement(fe,{onRname:function(e,t){j.find((function(e){return e.name===t}))?b([].concat(Object(u.a)(p),[r.a.createElement(R,{key:Date.now().toString()+Math.random().toString(),type:"error",onClose:function(e){var t=e.remove,a=e.hide;return t()?null:a()},text:"ce nom d'image existe d\xe9j\xe0"})])):(b([].concat(Object(u.a)(p),[r.a.createElement(R,{key:Date.now().toString()+Math.random().toString(),type:"success",onClose:function(e){var t=e.remove,a=e.hide;return t()?null:a()},text:"l'image ".concat(e," \xe0 \xe9t\xe9 re nom\xe9 en ").concat(t)})])),I(j.map((function(a){return a.name===e&&(a.name=t),a}))))},onRemove:function(e){return I(j.filter((function(t){return t.name!==e.name})))},items:j}):null,v.length?r.a.createElement("ul",null,v instanceof Array?v.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement(R,{type:"success",onClose:function(e){var t=e.remove,a=e.hide;return t()?null:a()},text:"L'image ".concat(e," \xe0 \xe9t\xe9 ajout\xe9 avec succ\xe9s")}))})):null):null)},be=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={loader:r.a.createElement(D,{width:16,type:"btn"}),redirect:!1,loadUser:r.a.createElement(D,{full:!0,width:48,type:"time",bg:"rgba(0,0,0,.9)"}),loaderAlbum:r.a.createElement(D,{full:!0,width:48,type:"az",bg:"rgba(0,0,0,.9)"}),album:null,errors:[]},document.title="Picsy | Album",a.onSubmit=a.onSubmit.bind(Object(p.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,null,[{key:"add",value:function(){return"add"}}]),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.action!==t.add()&&this.props.db.albums.doc(document.location.hash.split("/").pop()).get().then((function(t){e.setState({album:t,loaderAlbum:!1})})),this.userID=localStorage.getItem("useID")||w.a.getItem("useID");var a={loader:!1,redirect:r.a.createElement(k.c,{to:"/"})};this.props.db.isLogged(this.userID).then((function(t){t.success?e.setState({loader:!1,user:t.user,loadUser:!1}):e.setState(a)})).catch((function(){return e.setState(a)}))}},{key:"onSubmit",value:function(e){var t=this,a=e.name,n=e.refName,c=this.state.user;this.setState({loader:r.a.createElement(D,{width:16,type:"btn"})}),a.length>=2&&a.length<=42?(n.current instanceof Node&&(n.current.value="",n.current.focus()),this.props.db.addAlbum(a,c.id).then((function(e){e.success?t.setState({loader:!1,formHide:!0,errors:[],created:{ready:!1,album:e.album}},(function(){t.state.created.album.get().then((function(e){t.setState({created:{ready:!0,album:e}})}))})):t.setState((function(e){return{loader:!1,errors:[].concat(Object(u.a)(e.errors),[r.a.createElement(R,{key:Date.now(),type:"error",onClose:function(e){return(0,e.remove)()},text:"l'album ".concat(a," existe d\xe9j\xe0")})])}}))}))):this.setState((function(e){return{errors:[].concat(Object(u.a)(e.errors),[r.a.createElement(R,{key:Date.now(),type:"error",text:"taille de nom invalide",onClose:function(e){return(0,e.remove)()}})]),loader:!1}}))}},{key:"render",value:function(){var e=this.props.action,a=this.state,n=a.user,c=a.loader,o=a.loadUser,u=a.errors,i=a.formHide,l=a.created,s=a.loaderAlbum,m=a.album;return r.a.createElement(r.a.Fragment,null,r.a.createElement(B,{u:n,load:o}),e===t.add()?r.a.createElement(r.a.Fragment,null,r.a.createElement(te,{load:c,className:"".concat(i?"hide":""),type:"album",autoFocus:!0,onSubmit:this.onSubmit}),u,i&&r.a.createElement(R,{type:"success",text:r.a.createElement("span",null,"l'album",r.a.createElement(M.HashLink,{to:"/album/".concat(l.album.id)},l.ready?l.album.get("name"):".. .. ..")," \xe0 \xe9t\xe9 cr\xe9\xe9 avec succ\xe9s")}),r.a.createElement(R,{type:"back",text:r.a.createElement(r.a.Fragment,null,r.a.createElement(M.HashLink,{to:"/dash"},"Tableau de bord"))})):r.a.createElement(r.a.Fragment,null,r.a.createElement(pe,{db:this.props.db,loaderAlbum:s,album:m})))}}]),t}(r.a.Component),he=(a(103),function(e){function t(){return Object(s.a)(this,t),Object(f.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.blurValue,a=e.onChange,n=e.load,c=e.contrastValue,o=e.grayscaleValue,u=e.hueRotate;return r.a.createElement(r.a.Fragment,null,n||r.a.createElement("form",{className:"FormFilter"},r.a.createElement("div",null,r.a.createElement("label",null,"flootage ",r.a.createElement("i",null,t||0,"%")),r.a.createElement("input",{type:"range",min:"0",max:"100",defaultValue:t||0,onChange:function(e){e.preventDefault(),a({key:"blur",unity:"px",val:parseInt(e.target.value/2)})}})),r.a.createElement("div",null,r.a.createElement("label",null,"contraste ",r.a.createElement("i",null,c||0===c?c:100,"%")),r.a.createElement("input",{type:"range",min:"0",max:"1000",defaultValue:c||0===c?c:100,onChange:function(e){e.preventDefault(),a({key:"contrast",unity:"%",val:parseInt(e.target.value/2)})}})),r.a.createElement("div",null,r.a.createElement("label",null,"grisage ",r.a.createElement("i",null,o||0,"%")),r.a.createElement("input",{type:"range",min:"0",max:"100",defaultValue:o||0,onChange:function(e){e.preventDefault(),a({key:"grayscale",unity:"%",val:parseInt(e.target.value)})}})),r.a.createElement("div",null,r.a.createElement("label",null,"rotation teinte ",r.a.createElement("i",null,u||0,"\xb0")),r.a.createElement("input",{type:"range",min:"-8000",max:"8000",defaultValue:u||0,onChange:function(e){e.preventDefault(),a({key:"hueRotate",unity:"deg",val:parseInt(e.target.value)})}}))))}}]),t}(r.a.Component)),ge=(a(104),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={loaderImg:r.a.createElement(D,{width:64,type:"earth",bg:"rgba(0,0,0,.9)"}),loaderUser:r.a.createElement(D,{width:64,type:"timer",bg:"rgba(30,30,42,.95)"}),loaderForm:r.a.createElement(D,{width:48,type:"az",bg:"rgba(30,30,42,.95)"}),user:null,picture:null,redirect:null,blurValue:null,contrastValue:null,grayscaleValue:null,hueRotateValue:null,timeUpdate:20},a.pictureID=document.location.hash.split("/").pop(),a.updatePicture=a.updatePicture.bind(Object(p.a)(a)),a.timeUpdateUp=a.timeUpdateUp.bind(Object(p.a)(a)),document.title="Picsy | filtre",a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.updateID),clearInterval(this.timeUpdateID)}},{key:"componentDidMount",value:function(){var e=this;this.userID=localStorage.getItem("useID")||w.a.getItem("useID"),this.userID?this.props.db.getUser(this.userID).then((function(t){t?e.setState({u:t,loaderUser:!1},(function(){e.props.db.pictures.doc(e.pictureID).get().then((function(t){e.setState({picture:t,loaderImg:!1,loaderForm:!1,blurValue:2*parseInt((t.get("filters").find((function(e){return"blur"===e.key}))||{}).val),contrastValue:parseInt((t.get("filters").find((function(e){return"contrast"===e.key}))||{}).val),grayscaleValue:parseInt((t.get("filters").find((function(e){return"grayscale"===e.key}))||{}).val),hueRotateValue:parseInt((t.get("filters").find((function(e){return"hue-rotate"===e.key}))||{}).val)},(function(){e.updateID=setInterval(e.updatePicture,2e4),e.timeUpdateID=setInterval(e.timeUpdateUp,1e3)}))})).catch((function(t){e.setState({loaderImg:null,loaderUser:null,redirect:r.a.createElement(k.c,{to:"/"})})}))})):e.setState({loaderImg:null,loaderUser:null,redirect:r.a.createElement(k.c,{to:"/"})})})):this.setState({loaderImg:null,loaderUser:null,redirect:r.a.createElement(k.c,{to:"/"})})}},{key:"timeUpdateUp",value:function(){this.setState((function(e){return{timeUpdate:e.timeUpdate-1>=0?e.timeUpdate-1:0}}))}},{key:"updatePicture",value:function(){var e=this,t=this.state.picture,a=localStorage.getItem("filters-".concat(t.id));try{a=JSON.parse(a)}catch(n){a=[]}finally{a||(a=[])}setTimeout((function(){e.setState({loaderForm:r.a.createElement(D,{width:48,type:"az",bg:"rgba(30,30,42,.95)"})})}),420),this.props.db.pictureSetFilters(t.id,a).then((function(){e.props.db.pictures.doc(e.pictureID).get().then((function(a){e.setState({picture:a,loaderForm:!1,blurValue:2*parseInt((a.get("filters").find((function(e){return"blur"===e.key}))||{}).val),contrastValue:parseInt((a.get("filters").find((function(e){return"contrast"===e.key}))||{}).val),grayscaleValue:parseInt((a.get("filters").find((function(e){return"grayscale"===e.key}))||{}).val),hueRotateValue:parseInt((t.get("filters").find((function(e){return"hue-rotate"===e.key}))||{}).val),timeUpdate:20})}))}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.loaderImg,n=t.loaderUser,c=t.loaderForm,o=t.u,u=t.picture,i=t.blurValue,l=t.contrastValue,s=t.grayscaleValue,m=t.hueRotateValue,f=t.timeUpdate;return r.a.createElement("section",{className:"PictureRoute"},r.a.createElement("header",null,r.a.createElement(B,{u:o,load:n})),r.a.createElement(R,{type:"back",text:r.a.createElement(M.HashLink,{to:"/dash"},"tableau de bord")}),r.a.createElement("aside",null,r.a.createElement(ne,{load:a,pics:u,classFig:"fig-filter",figcaption:r.a.createElement(r.a.Fragment,null,!a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,u.get("name")),"- ",r.a.createElement("i",null,new Date(u.get("createAt")).toLocaleDateString()))),width:512})),r.a.createElement("p",{className:"update-pic"},!c&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,"Recalcul de l'image dans ",f),r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){clearInterval(e.updateID),e.updatePicture(),e.updateID=setInterval(e.updatePicture,2e4),e.setState({timeUpdate:20})}},"maintenant"))),r.a.createElement(he,{load:c,contrastValue:l,blurValue:i,grayscaleValue:s,hueRotate:m,onChange:function(t){var a=t.key,n=t.val,r=t.unity,c=localStorage.getItem("filters-".concat(u.id));try{c=JSON.parse(c)}catch(l){c=[]}finally{c||(c=[])}var o=!1;c=c.map((function(e){return e.key===a&&(e.val=n+r,o=!0),e})),o||c.push({key:a,val:n+r}),localStorage.setItem("filters-".concat(u.id),JSON.stringify(c));var i={};"blur"===a&&(n*=2),i[a+"Value"]=parseInt(n),e.setState(i)}}))}}]),t}(r.a.Component));a(105);var ve=function(e){var t=e.id,a=e.db,c=Object(n.useState)(r.a.createElement(D,{type:"earth",width:32,bg:"rgba(0,0,0,.9)"})),o=Object(C.a)(c,2),i=o[0],l=o[1],s=Object(n.useState)(null),m=Object(C.a)(s,2),f=m[0],d=m[1],p=Object(n.useState)(null),b=Object(C.a)(p,2),h=b[0],g=b[1],v=Object(n.useState)(!1),E=Object(C.a)(v,2),y=E[0],O=E[1],j=Object(n.useState)(!1),I=Object(C.a)(j,2),S=I[0],N=I[1],x=Object(n.useState)([]),F=Object(C.a)(x,2),A=F[0],R=F[1],U=Object(n.useState)(r.a.createElement(D,{type:"earth",width:32,bg:"rgba(0,0,0,.9)"})),P=Object(C.a)(U,2),T=P[0],L=P[1];return Object(n.useEffect)((function(){f||a.users.doc(t).get().then((function(e){d(e),l(!1),a.getAlbumsOf(e.id).then((function(e){N(e),L(!1),e.forEach((function(e){a.getPictureOf(e.id).then((function(e){R([].concat(Object(u.a)(A),Object(u.a)(e)))}))}))}))})).catch((function(e){console.error(e)}))})),r.a.createElement("li",{className:"AccountItem"},h,i||r.a.createElement("section",{id:"".concat(f.id),onMouseEnter:function(){return O(!0)},onMouseLeave:function(){return O(!1)},onFocus:function(){return O(!0)},onBlur:function(){return O(!1)}},r.a.createElement("button",{onClick:function(){w.a.setItem("useID",f.id),localStorage.setItem("useID",f.id),g(r.a.createElement(k.c,{to:"/dash"}))}},r.a.createElement("figure",null,r.a.createElement("figcaption",null,f.get("pseudo")),r.a.createElement("img",{src:f.get("avatar"),alt:"avatar",width:"64"})),r.a.createElement("aside",{className:"".concat(y?"":"o-hide")},T||r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",null,r.a.createElement("li",null,S.length," album",S.length>1?"s":""),r.a.createElement("li",null,A.length," image",A.length>1?"s":"")))))))},Ee=(a(106),function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={redirect:!1},a.userID=localStorage.getItem("userID")||w.a.getItem("userID");try{a.userID=JSON.parse(a.userID)}catch(n){a.userID=[]}return a.userID||(a.userID=[]),document.title="Picsy | comptes",a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.userID.length||this.setState({redirect:r.a.createElement(k.c,{to:"/"})})}},{key:"render",value:function(){var e=this.state.redirect,t=this.props.db;return r.a.createElement("section",{className:"AccountList"},e,r.a.createElement("ul",null,this.userID.map((function(e){return r.a.createElement(ve,{key:e,db:t,id:e})}))),r.a.createElement(R,{type:"back",text:r.a.createElement(M.HashLink,{to:"/dash"},"Tableau de bord")}))}}]),t}(r.a.Component)),ye=(a(107),function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(f.a)(this,Object(d.a)(t).call(this,e))).state={pseudo:"",fileName:"",avatar:t.defaultAvatar,errors:[],loaderSubmit:null},a.userID=localStorage.getItem("userID")||w.a.getItem("userID");try{a.userID=JSON.parse(a.userID)}catch(n){a.userID=[]}return a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.avatar,n=t.errors,c=t.fileName,o=t.loaderSubmit,i=t.redirect;return r.a.createElement("section",{className:"AddAccount"},i,r.a.createElement("h1",null,"Ajout\xe9",r.a.createElement("span",{className:"one-word"},"\xa0un\xa0"),r.a.createElement("span",{className:"user-word"},"utlisateur"),"\xa0",r.a.createElement("span",{className:"hide account-word"},"compte")),r.a.createElement(T,{onSubmit:function(t){t.preventDefault();var a=e.state.pseudo;if(a.length>=2&&a.length<=40){var n=e.state.avatar;e.setState({loaderSubmit:r.a.createElement(D,{width:16,type:"btn"})},(function(){e.props.db.users.add({pseudo:a,avatar:n}).then((function(t){e.userID||(e.userID=[]),e.userID.push(t.id),localStorage.setItem("userID",JSON.stringify(e.userID)),w.a.setItem("userID",JSON.stringify(e.userID),new Date(1.5*Date.now())),e.setState({redirect:r.a.createElement(k.c,{to:"/account-list"})})})).catch((function(e){return console.error(e)}))}))}else e.setState((function(e){return{errors:[].concat(Object(u.a)(e.errors),[r.a.createElement(R,{key:Date.now(),text:"pseudo taille invalide",type:"error",onClose:function(e){return(0,e.remove)()}})])}}))},onChangePseudo:function(t){return e.setState({pseudo:t.target.value.trim()})},avatar:a,fileName:c,errors:n,valuePseudo:this.state.pseudo,loaderSubmit:o,onChangeAvatar:function(t,a,n){if(t.size<=1e6&&/image/.test(t.type))e.setState({avatar:a,fileName:t.name});else{var c=t.size>=1e6?"fichier trop volumineux":"ce fichier n'est pas une image .";e.setState((function(e){return{errors:[].concat(Object(u.a)(e.errors),[r.a.createElement(R,{key:Date.now(),text:c,type:"error",onClose:function(e){return(0,e.remove)()}})])}}))}}}))}}]),t}(r.a.Component));ye.defaultAvatar="https://image.flaticon.com/icons/png/128/149/149071.png";var Oe=[{id:0,exact:!0,render:L,props:{},path:"/",name:"Home"},{id:1,exact:!1,render:$,props:{},path:"/dash",name:"dashboard"},{id:2,exact:!1,render:be,props:{action:"add"},path:"/add-album",name:"album add"},{id:3,exact:!1,render:be,props:{action:"show"},path:"/album/:id",name:"show album"},{id:5,exact:!1,render:ge,props:{},path:"/filter/:id",name:"filter album"},{id:6,exact:!1,render:ye,props:{},path:"/add-account",name:"filter album"},{id:6,exact:!1,render:Ee,props:{},path:"/account-list",name:"liste compte"}];var je=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.g,null,Oe.map((function(e){return r.a.createElement(k.d,{key:e.id,path:e.path,exact:e.exact,render:function(){return r.a.createElement(e.render,Object.assign({},e.props,{db:l}))}})}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ie=a(12);o.a.render(r.a.createElement(Ie.HashRouter,null,r.a.createElement(je,null)),document.getElementById("root"))}]),[[43,1,2]]]);
//# sourceMappingURL=main.bae6d6f0.chunk.js.map